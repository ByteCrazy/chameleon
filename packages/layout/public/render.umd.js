(function(y,A){typeof exports=="object"&&typeof module<"u"?A(exports,require("react"),require("react-dom")):typeof define=="function"&&define.amd?define(["exports","react","react-dom"],A):(y=typeof globalThis<"u"?globalThis:y||self,A(y.demo={},y.React,y.ReactDOM))})(this,function(y,A,K){"use strict";var ol=Object.defineProperty;var al=(y,A,K)=>A in y?ol(y,A,{enumerable:!0,configurable:!0,writable:!0,value:K}):y[A]=K;var w=(y,A,K)=>(al(y,typeof A!="symbol"?A+"":A,K),K);const ar=t=>t&&typeof t=="object"&&"default"in t?t:{default:t};function ir(t){if(t&&t.__esModule)return t;const e=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(t){for(const n in t)if(n!=="default"){const r=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(e,n,r.get?r:{enumerable:!0,get:()=>t[n]})}}return e.default=t,Object.freeze(e)}const W=ar(A),sr=ir(K),cr=t=>()=>{console.warn(`${t} need to be implement getComponent`)},ur=["customPageRootRender"],Te=["pageRender","render","convertModelToComponent","getComponent","getContext","getUtils","getDataLink","createDataLink","transformProps","transformData","transformGlobalData","errorCatch"],De=t=>[...Te,...ur].reduce((n,r)=>{var o;return t!=null&&t[r]?n[r]=(o=t[r])==null?void 0:o.bind(t):Te.includes(r)&&(n[r]=cr),n},{});var lr=Object.defineProperty,fr=(t,e,n)=>e in t?lr(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,h=(t,e,n)=>(fr(t,typeof e!="symbol"?e+"":e,n),n);class Ie extends TypeError{constructor(e,n){let r;const{message:o,...a}=e,{path:s}=e,i=s.length===0?o:"At path: "+s.join(".")+" -- "+o;super(i),this.value=void 0,this.key=void 0,this.type=void 0,this.refinement=void 0,this.path=void 0,this.branch=void 0,this.failures=void 0,Object.assign(this,a),this.name=this.constructor.name,this.failures=()=>{var c;return(c=r)!=null?c:r=[e,...n()]}}}function dr(t){return $(t)&&typeof t[Symbol.iterator]=="function"}function $(t){return typeof t=="object"&&t!=null}function R(t){return typeof t=="string"?JSON.stringify(t):""+t}function pr(t){const{done:e,value:n}=t.next();return e?void 0:n}function hr(t,e,n,r){if(t===!0)return;t===!1?t={}:typeof t=="string"&&(t={message:t});const{path:o,branch:a}=e,{type:s}=n,{refinement:i,message:c="Expected a value of type `"+s+"`"+(i?" with refinement `"+i+"`":"")+", but received: `"+R(r)+"`"}=t;return{value:r,type:s,refinement:i,key:o[o.length-1],path:o,branch:a,...t,message:c}}function*xe(t,e,n,r){dr(t)||(t=[t]);for(const o of t){const a=hr(o,e,n,r);a&&(yield a)}}function*Gt(t,e,n){n===void 0&&(n={});const{path:r=[],branch:o=[t],coerce:a=!1,mask:s=!1}=n,i={path:r,branch:o};if(a&&(t=e.coercer(t,i),s&&e.type!=="type"&&$(e.schema)&&$(t)&&!Array.isArray(t)))for(const u in t)e.schema[u]===void 0&&delete t[u];let c="valid";for(const u of e.validator(t,i))c="not_valid",yield[u,void 0];for(let[u,l,d]of e.entries(t,i)){const v=Gt(l,d,{path:u===void 0?r:[...r,u],branch:u===void 0?o:[...o,l],coerce:a,mask:s});for(const g of v)g[0]?(c=g[0].refinement!=null?"not_refined":"not_valid",yield[g[0],void 0]):a&&(l=g[1],u===void 0?t=l:t instanceof Map?t.set(u,l):t instanceof Set?t.add(l):$(t)&&(t[u]=l))}if(c!=="not_valid")for(const u of e.refiner(t,i))c="not_refined",yield[u,void 0];c==="valid"&&(yield[void 0,t])}class B{constructor(e){this.TYPE=void 0,this.type=void 0,this.schema=void 0,this.coercer=void 0,this.validator=void 0,this.refiner=void 0,this.entries=void 0;const{type:n,schema:r,validator:o,refiner:a,coercer:s=c=>c,entries:i=function*(){}}=e;this.type=n,this.schema=r,this.entries=i,this.coercer=s,o?this.validator=(c,u)=>{const l=o(c,u);return xe(l,u,this,c)}:this.validator=()=>[],a?this.refiner=(c,u)=>{const l=a(c,u);return xe(l,u,this,c)}:this.refiner=()=>[]}assert(e){return $e(e,this)}create(e){return vr(e,this)}is(e){return mr(e,this)}mask(e){return yr(e,this)}validate(e,n){return n===void 0&&(n={}),at(e,this,n)}}function $e(t,e){const n=at(t,e);if(n[0])throw n[0]}function vr(t,e){const n=at(t,e,{coerce:!0});if(n[0])throw n[0];return n[1]}function yr(t,e){const n=at(t,e,{coerce:!0,mask:!0});if(n[0])throw n[0];return n[1]}function mr(t,e){return!at(t,e)[0]}function at(t,e,n){n===void 0&&(n={});const r=Gt(t,e,n),o=pr(r);if(o[0])return[new Ie(o[0],function*(){for(const a of r)a[0]&&(yield a[0])}),void 0];{const a=o[1];return[void 0,a]}}function Fe(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const r=e[0].type==="type",o=e.map(s=>s.schema),a=Object.assign({},...o);return r?Ge(a):m(a)}function Q(t,e){return new B({type:t,schema:null,validator:e})}function it(t){return new B({type:"dynamic",schema:null,*entries(e,n){yield*t(e,n).entries(e,n)},validator(e,n){return t(e,n).validator(e,n)},coercer(e,n){return t(e,n).coercer(e,n)},refiner(e,n){return t(e,n).refiner(e,n)}})}function ke(t,e){const{schema:n}=t,r={...n};for(const o of e)delete r[o];switch(t.type){case"type":return Ge(r);default:return m(r)}}function L(){return Q("any",()=>!0)}function P(t){return new B({type:"array",schema:t,*entries(e){if(t&&Array.isArray(e))for(const[n,r]of e.entries())yield[n,r,t]},coercer(e){return Array.isArray(e)?e.slice():e},validator(e){return Array.isArray(e)||"Expected an array value, but received: "+R(e)}})}function H(){return Q("boolean",t=>typeof t=="boolean")}function Ut(t){const e={},n=t.map(r=>R(r)).join();for(const r of t)e[r]=r;return new B({type:"enums",schema:e,validator(r){return t.includes(r)||"Expected one of `"+n+"`, but received: "+R(r)}})}function Be(){return Q("func",t=>typeof t=="function"||"Expected a function, but received: "+R(t))}function T(t){const e=R(t),n=typeof t;return new B({type:"literal",schema:n==="string"||n==="number"||n==="boolean"?t:null,validator(r){return r===t||"Expected the literal `"+e+"`, but received: "+R(r)}})}function gr(){return Q("never",()=>!1)}function Le(){return Q("number",t=>typeof t=="number"&&!isNaN(t)||"Expected a number, but received: "+R(t))}function m(t){const e=t?Object.keys(t):[],n=gr();return new B({type:"object",schema:t||null,*entries(r){if(t&&$(r)){const o=new Set(Object.keys(r));for(const a of e)o.delete(a),yield[a,r[a],t[a]];for(const a of o)yield[a,r[a],n]}},validator(r){return $(r)||"Expected an object, but received: "+R(r)},coercer(r){return $(r)?{...r}:r}})}function p(t){return new B({...t,validator:(e,n)=>e===void 0||t.validator(e,n),refiner:(e,n)=>e===void 0||t.refiner(e,n)})}function pt(t,e){return new B({type:"record",schema:null,*entries(n){if($(n))for(const r in n){const o=n[r];yield[r,r,t],yield[r,o,e]}},validator(n){return $(n)||"Expected an object, but received: "+R(n)}})}function f(){return Q("string",t=>typeof t=="string"||"Expected a string, but received: "+R(t))}function Ge(t){const e=Object.keys(t);return new B({type:"type",schema:t,*entries(n){if($(n))for(const r of e)yield[r,n[r],t[r]]},validator(n){return $(n)||"Expected an object, but received: "+R(n)}})}function M(t){const e=t.map(n=>n.type).join(" | ");return new B({type:"union",schema:null,coercer(n,r){return(t.find(o=>{const[a]=o.validate(n,{coerce:!0});return!a})||br()).coercer(n,r)},validator(n,r){const o=[];for(const a of t){const[...s]=Gt(n,a,r),[i]=s;if(i[0])for(const[c]of s)c&&o.push(c);else return[]}return["Expected the value to satisfy a union of `"+e+"`, but received: "+R(n),...o]}})}function br(){return Q("unknown",()=>!0)}var jr=typeof global=="object"&&global&&global.Object===Object&&global;const Ue=jr;var _r=typeof self=="object"&&self&&self.Object===Object&&self,Or=Ue||_r||Function("return this")();const G=Or;var wr=G.Symbol;const x=wr;var ze=Object.prototype,Cr=ze.hasOwnProperty,Er=ze.toString,ht=x?x.toStringTag:void 0;function Nr(t){var e=Cr.call(t,ht),n=t[ht];try{t[ht]=void 0;var r=!0}catch{}var o=Er.call(t);return r&&(e?t[ht]=n:delete t[ht]),o}var Sr=Object.prototype,Ar=Sr.toString;function Pr(t){return Ar.call(t)}var Mr="[object Null]",Rr="[object Undefined]",Ve=x?x.toStringTag:void 0;function Z(t){return t==null?t===void 0?Rr:Mr:Ve&&Ve in Object(t)?Nr(t):Pr(t)}function J(t){return t!=null&&typeof t=="object"}var Tr="[object Symbol]";function zt(t){return typeof t=="symbol"||J(t)&&Z(t)==Tr}function Vt(t,e){for(var n=-1,r=t==null?0:t.length,o=Array(r);++n<r;)o[n]=e(t[n],n,t);return o}var Dr=Array.isArray;const N=Dr;var Ir=1/0,We=x?x.prototype:void 0,He=We?We.toString:void 0;function Je(t){if(typeof t=="string")return t;if(N(t))return Vt(t,Je)+"";if(zt(t))return He?He.call(t):"";var e=t+"";return e=="0"&&1/t==-Ir?"-0":e}function q(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}function Xe(t){return t}var xr="[object AsyncFunction]",$r="[object Function]",Fr="[object GeneratorFunction]",kr="[object Proxy]";function Ye(t){if(!q(t))return!1;var e=Z(t);return e==$r||e==Fr||e==xr||e==kr}var Br=G["__core-js_shared__"];const Wt=Br;var Qe=function(){var t=/[^.]+$/.exec(Wt&&Wt.keys&&Wt.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();function Lr(t){return!!Qe&&Qe in t}var Gr=Function.prototype,Ur=Gr.toString;function tt(t){if(t!=null){try{return Ur.call(t)}catch{}try{return t+""}catch{}}return""}var zr=/[\\^$.*+?()[\]{}|]/g,Vr=/^\[object .+?Constructor\]$/,Wr=Function.prototype,Hr=Object.prototype,Jr=Wr.toString,Xr=Hr.hasOwnProperty,Yr=RegExp("^"+Jr.call(Xr).replace(zr,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Qr(t){if(!q(t)||Lr(t))return!1;var e=Ye(t)?Yr:Vr;return e.test(tt(t))}function qr(t,e){return t==null?void 0:t[e]}function et(t,e){var n=qr(t,e);return Qr(n)?n:void 0}var Kr=et(G,"WeakMap");const Ht=Kr;var qe=Object.create,Zr=function(){function t(){}return function(e){if(!q(e))return{};if(qe)return qe(e);t.prototype=e;var n=new t;return t.prototype=void 0,n}}();const to=Zr;function eo(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}function no(t,e){var n=-1,r=t.length;for(e||(e=Array(r));++n<r;)e[n]=t[n];return e}var ro=800,oo=16,ao=Date.now;function io(t){var e=0,n=0;return function(){var r=ao(),o=oo-(r-n);if(n=r,o>0){if(++e>=ro)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}function so(t){return function(){return t}}var co=function(){try{var t=et(Object,"defineProperty");return t({},"",{}),t}catch{}}();const Ct=co;var uo=Ct?function(t,e){return Ct(t,"toString",{configurable:!0,enumerable:!1,value:so(e),writable:!0})}:Xe,lo=io(uo);const fo=lo;function po(t,e){for(var n=-1,r=t==null?0:t.length;++n<r&&e(t[n],n,t)!==!1;);return t}var ho=9007199254740991,vo=/^(?:0|[1-9]\d*)$/;function Jt(t,e){var n=typeof t;return e=e==null?ho:e,!!e&&(n=="number"||n!="symbol"&&vo.test(t))&&t>-1&&t%1==0&&t<e}function Ke(t,e,n){e=="__proto__"&&Ct?Ct(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}function Xt(t,e){return t===e||t!==t&&e!==e}var yo=Object.prototype,mo=yo.hasOwnProperty;function Yt(t,e,n){var r=t[e];(!(mo.call(t,e)&&Xt(r,n))||n===void 0&&!(e in t))&&Ke(t,e,n)}function vt(t,e,n,r){var o=!n;n||(n={});for(var a=-1,s=e.length;++a<s;){var i=e[a],c=r?r(n[i],t[i],i,n,t):void 0;c===void 0&&(c=t[i]),o?Ke(n,i,c):Yt(n,i,c)}return n}var Ze=Math.max;function go(t,e,n){return e=Ze(e===void 0?t.length-1:e,0),function(){for(var r=arguments,o=-1,a=Ze(r.length-e,0),s=Array(a);++o<a;)s[o]=r[e+o];o=-1;for(var i=Array(e+1);++o<e;)i[o]=r[o];return i[e]=n(s),eo(t,this,i)}}var bo=9007199254740991;function Qt(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=bo}function tn(t){return t!=null&&Qt(t.length)&&!Ye(t)}var jo=Object.prototype;function qt(t){var e=t&&t.constructor,n=typeof e=="function"&&e.prototype||jo;return t===n}function _o(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}var Oo="[object Arguments]";function en(t){return J(t)&&Z(t)==Oo}var nn=Object.prototype,wo=nn.hasOwnProperty,Co=nn.propertyIsEnumerable,Eo=en(function(){return arguments}())?en:function(t){return J(t)&&wo.call(t,"callee")&&!Co.call(t,"callee")};const Kt=Eo;function No(){return!1}var rn=typeof y=="object"&&y&&!y.nodeType&&y,on=rn&&typeof module=="object"&&module&&!module.nodeType&&module,So=on&&on.exports===rn,an=So?G.Buffer:void 0,Ao=an?an.isBuffer:void 0,Po=Ao||No;const Et=Po;var Mo="[object Arguments]",Ro="[object Array]",To="[object Boolean]",Do="[object Date]",Io="[object Error]",xo="[object Function]",$o="[object Map]",Fo="[object Number]",ko="[object Object]",Bo="[object RegExp]",Lo="[object Set]",Go="[object String]",Uo="[object WeakMap]",zo="[object ArrayBuffer]",Vo="[object DataView]",Wo="[object Float32Array]",Ho="[object Float64Array]",Jo="[object Int8Array]",Xo="[object Int16Array]",Yo="[object Int32Array]",Qo="[object Uint8Array]",qo="[object Uint8ClampedArray]",Ko="[object Uint16Array]",Zo="[object Uint32Array]",j={};j[Wo]=j[Ho]=j[Jo]=j[Xo]=j[Yo]=j[Qo]=j[qo]=j[Ko]=j[Zo]=!0,j[Mo]=j[Ro]=j[zo]=j[To]=j[Vo]=j[Do]=j[Io]=j[xo]=j[$o]=j[Fo]=j[ko]=j[Bo]=j[Lo]=j[Go]=j[Uo]=!1;function ta(t){return J(t)&&Qt(t.length)&&!!j[Z(t)]}function Zt(t){return function(e){return t(e)}}var sn=typeof y=="object"&&y&&!y.nodeType&&y,yt=sn&&typeof module=="object"&&module&&!module.nodeType&&module,ea=yt&&yt.exports===sn,te=ea&&Ue.process,na=function(){try{var t=yt&&yt.require&&yt.require("util").types;return t||te&&te.binding&&te.binding("util")}catch{}}();const st=na;var cn=st&&st.isTypedArray,ra=cn?Zt(cn):ta;const un=ra;var oa=Object.prototype,aa=oa.hasOwnProperty;function ln(t,e){var n=N(t),r=!n&&Kt(t),o=!n&&!r&&Et(t),a=!n&&!r&&!o&&un(t),s=n||r||o||a,i=s?_o(t.length,String):[],c=i.length;for(var u in t)(e||aa.call(t,u))&&!(s&&(u=="length"||o&&(u=="offset"||u=="parent")||a&&(u=="buffer"||u=="byteLength"||u=="byteOffset")||Jt(u,c)))&&i.push(u);return i}function fn(t,e){return function(n){return t(e(n))}}var ia=fn(Object.keys,Object);const sa=ia;var ca=Object.prototype,ua=ca.hasOwnProperty;function la(t){if(!qt(t))return sa(t);var e=[];for(var n in Object(t))ua.call(t,n)&&n!="constructor"&&e.push(n);return e}function Nt(t){return tn(t)?ln(t):la(t)}function fa(t){var e=[];if(t!=null)for(var n in Object(t))e.push(n);return e}var da=Object.prototype,pa=da.hasOwnProperty;function ha(t){if(!q(t))return fa(t);var e=qt(t),n=[];for(var r in t)r=="constructor"&&(e||!pa.call(t,r))||n.push(r);return n}function ee(t){return tn(t)?ln(t,!0):ha(t)}var va=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,ya=/^\w*$/;function ne(t,e){if(N(t))return!1;var n=typeof t;return n=="number"||n=="symbol"||n=="boolean"||t==null||zt(t)?!0:ya.test(t)||!va.test(t)||e!=null&&t in Object(e)}var ma=et(Object,"create");const mt=ma;function ga(){this.__data__=mt?mt(null):{},this.size=0}function ba(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}var ja="__lodash_hash_undefined__",_a=Object.prototype,Oa=_a.hasOwnProperty;function wa(t){var e=this.__data__;if(mt){var n=e[t];return n===ja?void 0:n}return Oa.call(e,t)?e[t]:void 0}var Ca=Object.prototype,Ea=Ca.hasOwnProperty;function Na(t){var e=this.__data__;return mt?e[t]!==void 0:Ea.call(e,t)}var Sa="__lodash_hash_undefined__";function Aa(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=mt&&e===void 0?Sa:e,this}function nt(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}nt.prototype.clear=ga,nt.prototype.delete=ba,nt.prototype.get=wa,nt.prototype.has=Na,nt.prototype.set=Aa;function Pa(){this.__data__=[],this.size=0}function St(t,e){for(var n=t.length;n--;)if(Xt(t[n][0],e))return n;return-1}var Ma=Array.prototype,Ra=Ma.splice;function Ta(t){var e=this.__data__,n=St(e,t);if(n<0)return!1;var r=e.length-1;return n==r?e.pop():Ra.call(e,n,1),--this.size,!0}function Da(t){var e=this.__data__,n=St(e,t);return n<0?void 0:e[n][1]}function Ia(t){return St(this.__data__,t)>-1}function xa(t,e){var n=this.__data__,r=St(n,t);return r<0?(++this.size,n.push([t,e])):n[r][1]=e,this}function X(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}X.prototype.clear=Pa,X.prototype.delete=Ta,X.prototype.get=Da,X.prototype.has=Ia,X.prototype.set=xa;var $a=et(G,"Map");const gt=$a;function Fa(){this.size=0,this.__data__={hash:new nt,map:new(gt||X),string:new nt}}function ka(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}function At(t,e){var n=t.__data__;return ka(e)?n[typeof e=="string"?"string":"hash"]:n.map}function Ba(t){var e=At(this,t).delete(t);return this.size-=e?1:0,e}function La(t){return At(this,t).get(t)}function Ga(t){return At(this,t).has(t)}function Ua(t,e){var n=At(this,t),r=n.size;return n.set(t,e),this.size+=n.size==r?0:1,this}function Y(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}Y.prototype.clear=Fa,Y.prototype.delete=Ba,Y.prototype.get=La,Y.prototype.has=Ga,Y.prototype.set=Ua;var za="Expected a function";function re(t,e){if(typeof t!="function"||e!=null&&typeof e!="function")throw new TypeError(za);var n=function(){var r=arguments,o=e?e.apply(this,r):r[0],a=n.cache;if(a.has(o))return a.get(o);var s=t.apply(this,r);return n.cache=a.set(o,s)||a,s};return n.cache=new(re.Cache||Y),n}re.Cache=Y;var Va=500;function Wa(t){var e=re(t,function(r){return n.size===Va&&n.clear(),r}),n=e.cache;return e}var Ha=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Ja=/\\(\\)?/g,Xa=Wa(function(t){var e=[];return t.charCodeAt(0)===46&&e.push(""),t.replace(Ha,function(n,r,o,a){e.push(o?a.replace(Ja,"$1"):r||n)}),e});const Ya=Xa;function Qa(t){return t==null?"":Je(t)}function ct(t,e){return N(t)?t:ne(t,e)?[t]:Ya(Qa(t))}var qa=1/0;function ut(t){if(typeof t=="string"||zt(t))return t;var e=t+"";return e=="0"&&1/t==-qa?"-0":e}function Pt(t,e){e=ct(e,t);for(var n=0,r=e.length;t!=null&&n<r;)t=t[ut(e[n++])];return n&&n==r?t:void 0}function Ka(t,e,n){var r=t==null?void 0:Pt(t,e);return r===void 0?n:r}function oe(t,e){for(var n=-1,r=e.length,o=t.length;++n<r;)t[o+n]=e[n];return t}var dn=x?x.isConcatSpreadable:void 0;function Za(t){return N(t)||Kt(t)||!!(dn&&t&&t[dn])}function pn(t,e,n,r,o){var a=-1,s=t.length;for(n||(n=Za),o||(o=[]);++a<s;){var i=t[a];e>0&&n(i)?e>1?pn(i,e-1,n,r,o):oe(o,i):r||(o[o.length]=i)}return o}function ti(t){var e=t==null?0:t.length;return e?pn(t,1):[]}function ei(t){return fo(go(t,void 0,ti),t+"")}var ni=fn(Object.getPrototypeOf,Object);const ae=ni;var ri="[object Object]",oi=Function.prototype,ai=Object.prototype,hn=oi.toString,ii=ai.hasOwnProperty,si=hn.call(Object);function D(t){if(!J(t)||Z(t)!=ri)return!1;var e=ae(t);if(e===null)return!0;var n=ii.call(e,"constructor")&&e.constructor;return typeof n=="function"&&n instanceof n&&hn.call(n)==si}function ci(t,e,n){var r=-1,o=t.length;e<0&&(e=-e>o?0:o+e),n=n>o?o:n,n<0&&(n+=o),o=e>n?0:n-e>>>0,e>>>=0;for(var a=Array(o);++r<o;)a[r]=t[r+e];return a}function ui(){this.__data__=new X,this.size=0}function li(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n}function fi(t){return this.__data__.get(t)}function di(t){return this.__data__.has(t)}var pi=200;function hi(t,e){var n=this.__data__;if(n instanceof X){var r=n.__data__;if(!gt||r.length<pi-1)return r.push([t,e]),this.size=++n.size,this;n=this.__data__=new Y(r)}return n.set(t,e),this.size=n.size,this}function U(t){var e=this.__data__=new X(t);this.size=e.size}U.prototype.clear=ui,U.prototype.delete=li,U.prototype.get=fi,U.prototype.has=di,U.prototype.set=hi;function vi(t,e){return t&&vt(e,Nt(e),t)}function yi(t,e){return t&&vt(e,ee(e),t)}var vn=typeof y=="object"&&y&&!y.nodeType&&y,yn=vn&&typeof module=="object"&&module&&!module.nodeType&&module,mi=yn&&yn.exports===vn,mn=mi?G.Buffer:void 0,gn=mn?mn.allocUnsafe:void 0;function gi(t,e){if(e)return t.slice();var n=t.length,r=gn?gn(n):new t.constructor(n);return t.copy(r),r}function bi(t,e){for(var n=-1,r=t==null?0:t.length,o=0,a=[];++n<r;){var s=t[n];e(s,n,t)&&(a[o++]=s)}return a}function bn(){return[]}var ji=Object.prototype,_i=ji.propertyIsEnumerable,jn=Object.getOwnPropertySymbols,Oi=jn?function(t){return t==null?[]:(t=Object(t),bi(jn(t),function(e){return _i.call(t,e)}))}:bn;const ie=Oi;function wi(t,e){return vt(t,ie(t),e)}var Ci=Object.getOwnPropertySymbols,Ei=Ci?function(t){for(var e=[];t;)oe(e,ie(t)),t=ae(t);return e}:bn;const _n=Ei;function Ni(t,e){return vt(t,_n(t),e)}function On(t,e,n){var r=e(t);return N(t)?r:oe(r,n(t))}function se(t){return On(t,Nt,ie)}function ce(t){return On(t,ee,_n)}var Si=et(G,"DataView");const ue=Si;var Ai=et(G,"Promise");const le=Ai;var Pi=et(G,"Set");const fe=Pi;var wn="[object Map]",Mi="[object Object]",Cn="[object Promise]",En="[object Set]",Nn="[object WeakMap]",Sn="[object DataView]",Ri=tt(ue),Ti=tt(gt),Di=tt(le),Ii=tt(fe),xi=tt(Ht),rt=Z;(ue&&rt(new ue(new ArrayBuffer(1)))!=Sn||gt&&rt(new gt)!=wn||le&&rt(le.resolve())!=Cn||fe&&rt(new fe)!=En||Ht&&rt(new Ht)!=Nn)&&(rt=function(t){var e=Z(t),n=e==Mi?t.constructor:void 0,r=n?tt(n):"";if(r)switch(r){case Ri:return Sn;case Ti:return wn;case Di:return Cn;case Ii:return En;case xi:return Nn}return e});const bt=rt;var $i=Object.prototype,Fi=$i.hasOwnProperty;function ki(t){var e=t.length,n=new t.constructor(e);return e&&typeof t[0]=="string"&&Fi.call(t,"index")&&(n.index=t.index,n.input=t.input),n}var Bi=G.Uint8Array;const Mt=Bi;function de(t){var e=new t.constructor(t.byteLength);return new Mt(e).set(new Mt(t)),e}function Li(t,e){var n=e?de(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.byteLength)}var Gi=/\w*$/;function Ui(t){var e=new t.constructor(t.source,Gi.exec(t));return e.lastIndex=t.lastIndex,e}var An=x?x.prototype:void 0,Pn=An?An.valueOf:void 0;function zi(t){return Pn?Object(Pn.call(t)):{}}function Vi(t,e){var n=e?de(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.length)}var Wi="[object Boolean]",Hi="[object Date]",Ji="[object Map]",Xi="[object Number]",Yi="[object RegExp]",Qi="[object Set]",qi="[object String]",Ki="[object Symbol]",Zi="[object ArrayBuffer]",ts="[object DataView]",es="[object Float32Array]",ns="[object Float64Array]",rs="[object Int8Array]",os="[object Int16Array]",as="[object Int32Array]",is="[object Uint8Array]",ss="[object Uint8ClampedArray]",cs="[object Uint16Array]",us="[object Uint32Array]";function ls(t,e,n){var r=t.constructor;switch(e){case Zi:return de(t);case Wi:case Hi:return new r(+t);case ts:return Li(t,n);case es:case ns:case rs:case os:case as:case is:case ss:case cs:case us:return Vi(t,n);case Ji:return new r;case Xi:case qi:return new r(t);case Yi:return Ui(t);case Qi:return new r;case Ki:return zi(t)}}function fs(t){return typeof t.constructor=="function"&&!qt(t)?to(ae(t)):{}}var ds="[object Map]";function ps(t){return J(t)&&bt(t)==ds}var Mn=st&&st.isMap,hs=Mn?Zt(Mn):ps;const vs=hs;var ys="[object Set]";function ms(t){return J(t)&&bt(t)==ys}var Rn=st&&st.isSet,gs=Rn?Zt(Rn):ms;const bs=gs;var js=1,_s=2,Os=4,Tn="[object Arguments]",ws="[object Array]",Cs="[object Boolean]",Es="[object Date]",Ns="[object Error]",Dn="[object Function]",Ss="[object GeneratorFunction]",As="[object Map]",Ps="[object Number]",In="[object Object]",Ms="[object RegExp]",Rs="[object Set]",Ts="[object String]",Ds="[object Symbol]",Is="[object WeakMap]",xs="[object ArrayBuffer]",$s="[object DataView]",Fs="[object Float32Array]",ks="[object Float64Array]",Bs="[object Int8Array]",Ls="[object Int16Array]",Gs="[object Int32Array]",Us="[object Uint8Array]",zs="[object Uint8ClampedArray]",Vs="[object Uint16Array]",Ws="[object Uint32Array]",b={};b[Tn]=b[ws]=b[xs]=b[$s]=b[Cs]=b[Es]=b[Fs]=b[ks]=b[Bs]=b[Ls]=b[Gs]=b[As]=b[Ps]=b[In]=b[Ms]=b[Rs]=b[Ts]=b[Ds]=b[Us]=b[zs]=b[Vs]=b[Ws]=!0,b[Ns]=b[Dn]=b[Is]=!1;function Rt(t,e,n,r,o,a){var s,i=e&js,c=e&_s,u=e&Os;if(n&&(s=o?n(t,r,o,a):n(t)),s!==void 0)return s;if(!q(t))return t;var l=N(t);if(l){if(s=ki(t),!i)return no(t,s)}else{var d=bt(t),v=d==Dn||d==Ss;if(Et(t))return gi(t,i);if(d==In||d==Tn||v&&!o){if(s=c||v?{}:fs(t),!i)return c?Ni(t,yi(s,t)):wi(t,vi(s,t))}else{if(!b[d])return o?t:{};s=ls(t,d,i)}}a||(a=new U);var g=a.get(t);if(g)return g;a.set(t,s),bs(t)?t.forEach(function(O){s.add(Rt(O,e,n,O,t,a))}):vs(t)&&t.forEach(function(O,E){s.set(E,Rt(O,e,n,E,t,a))});var C=u?c?ce:se:c?ee:Nt,S=l?void 0:C(t);return po(S||t,function(O,E){S&&(E=O,O=t[E]),Yt(s,E,Rt(O,e,n,E,t,a))}),s}var Hs="__lodash_hash_undefined__";function Js(t){return this.__data__.set(t,Hs),this}function Xs(t){return this.__data__.has(t)}function Tt(t){var e=-1,n=t==null?0:t.length;for(this.__data__=new Y;++e<n;)this.add(t[e])}Tt.prototype.add=Tt.prototype.push=Js,Tt.prototype.has=Xs;function Ys(t,e){for(var n=-1,r=t==null?0:t.length;++n<r;)if(e(t[n],n,t))return!0;return!1}function Qs(t,e){return t.has(e)}var qs=1,Ks=2;function xn(t,e,n,r,o,a){var s=n&qs,i=t.length,c=e.length;if(i!=c&&!(s&&c>i))return!1;var u=a.get(t),l=a.get(e);if(u&&l)return u==e&&l==t;var d=-1,v=!0,g=n&Ks?new Tt:void 0;for(a.set(t,e),a.set(e,t);++d<i;){var C=t[d],S=e[d];if(r)var O=s?r(S,C,d,e,t,a):r(C,S,d,t,e,a);if(O!==void 0){if(O)continue;v=!1;break}if(g){if(!Ys(e,function(E,I){if(!Qs(g,I)&&(C===E||o(C,E,n,r,a)))return g.push(I)})){v=!1;break}}else if(!(C===S||o(C,S,n,r,a))){v=!1;break}}return a.delete(t),a.delete(e),v}function Zs(t){var e=-1,n=Array(t.size);return t.forEach(function(r,o){n[++e]=[o,r]}),n}function tc(t){var e=-1,n=Array(t.size);return t.forEach(function(r){n[++e]=r}),n}var ec=1,nc=2,rc="[object Boolean]",oc="[object Date]",ac="[object Error]",ic="[object Map]",sc="[object Number]",cc="[object RegExp]",uc="[object Set]",lc="[object String]",fc="[object Symbol]",dc="[object ArrayBuffer]",pc="[object DataView]",$n=x?x.prototype:void 0,pe=$n?$n.valueOf:void 0;function hc(t,e,n,r,o,a,s){switch(n){case pc:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case dc:return!(t.byteLength!=e.byteLength||!a(new Mt(t),new Mt(e)));case rc:case oc:case sc:return Xt(+t,+e);case ac:return t.name==e.name&&t.message==e.message;case cc:case lc:return t==e+"";case ic:var i=Zs;case uc:var c=r&ec;if(i||(i=tc),t.size!=e.size&&!c)return!1;var u=s.get(t);if(u)return u==e;r|=nc,s.set(t,e);var l=xn(i(t),i(e),r,o,a,s);return s.delete(t),l;case fc:if(pe)return pe.call(t)==pe.call(e)}return!1}var vc=1,yc=Object.prototype,mc=yc.hasOwnProperty;function gc(t,e,n,r,o,a){var s=n&vc,i=se(t),c=i.length,u=se(e),l=u.length;if(c!=l&&!s)return!1;for(var d=c;d--;){var v=i[d];if(!(s?v in e:mc.call(e,v)))return!1}var g=a.get(t),C=a.get(e);if(g&&C)return g==e&&C==t;var S=!0;a.set(t,e),a.set(e,t);for(var O=s;++d<c;){v=i[d];var E=t[v],I=e[v];if(r)var wt=s?r(I,E,v,e,t,a):r(E,I,v,t,e,a);if(!(wt===void 0?E===I||o(E,I,n,r,a):wt)){S=!1;break}O||(O=v=="constructor")}if(S&&!O){var k=t.constructor,V=e.constructor;k!=V&&"constructor"in t&&"constructor"in e&&!(typeof k=="function"&&k instanceof k&&typeof V=="function"&&V instanceof V)&&(S=!1)}return a.delete(t),a.delete(e),S}var bc=1,Fn="[object Arguments]",kn="[object Array]",Dt="[object Object]",jc=Object.prototype,Bn=jc.hasOwnProperty;function _c(t,e,n,r,o,a){var s=N(t),i=N(e),c=s?kn:bt(t),u=i?kn:bt(e);c=c==Fn?Dt:c,u=u==Fn?Dt:u;var l=c==Dt,d=u==Dt,v=c==u;if(v&&Et(t)){if(!Et(e))return!1;s=!0,l=!1}if(v&&!l)return a||(a=new U),s||un(t)?xn(t,e,n,r,o,a):hc(t,e,c,n,r,o,a);if(!(n&bc)){var g=l&&Bn.call(t,"__wrapped__"),C=d&&Bn.call(e,"__wrapped__");if(g||C){var S=g?t.value():t,O=C?e.value():e;return a||(a=new U),o(S,O,n,r,a)}}return v?(a||(a=new U),gc(t,e,n,r,o,a)):!1}function he(t,e,n,r,o){return t===e?!0:t==null||e==null||!J(t)&&!J(e)?t!==t&&e!==e:_c(t,e,n,r,he,o)}var Oc=1,wc=2;function Cc(t,e,n,r){var o=n.length,a=o,s=!r;if(t==null)return!a;for(t=Object(t);o--;){var i=n[o];if(s&&i[2]?i[1]!==t[i[0]]:!(i[0]in t))return!1}for(;++o<a;){i=n[o];var c=i[0],u=t[c],l=i[1];if(s&&i[2]){if(u===void 0&&!(c in t))return!1}else{var d=new U;if(r)var v=r(u,l,c,t,e,d);if(!(v===void 0?he(l,u,Oc|wc,r,d):v))return!1}}return!0}function Ln(t){return t===t&&!q(t)}function Ec(t){for(var e=Nt(t),n=e.length;n--;){var r=e[n],o=t[r];e[n]=[r,o,Ln(o)]}return e}function Gn(t,e){return function(n){return n==null?!1:n[t]===e&&(e!==void 0||t in Object(n))}}function Nc(t){var e=Ec(t);return e.length==1&&e[0][2]?Gn(e[0][0],e[0][1]):function(n){return n===t||Cc(n,t,e)}}function Sc(t,e){return t!=null&&e in Object(t)}function Ac(t,e,n){e=ct(e,t);for(var r=-1,o=e.length,a=!1;++r<o;){var s=ut(e[r]);if(!(a=t!=null&&n(t,s)))break;t=t[s]}return a||++r!=o?a:(o=t==null?0:t.length,!!o&&Qt(o)&&Jt(s,o)&&(N(t)||Kt(t)))}function Pc(t,e){return t!=null&&Ac(t,e,Sc)}var Mc=1,Rc=2;function Tc(t,e){return ne(t)&&Ln(e)?Gn(ut(t),e):function(n){var r=Ka(n,t);return r===void 0&&r===e?Pc(n,t):he(e,r,Mc|Rc)}}function Dc(t){return function(e){return e==null?void 0:e[t]}}function Ic(t){return function(e){return Pt(e,t)}}function xc(t){return ne(t)?Dc(ut(t)):Ic(t)}function Un(t){return typeof t=="function"?t:t==null?Xe:typeof t=="object"?N(t)?Tc(t[0],t[1]):Nc(t):xc(t)}function $c(t){var e=t==null?0:t.length;return e?t[e-1]:void 0}function Fc(t,e){return e.length<2?t:Pt(t,ci(e,0,-1))}var kc="Expected a function";function Bc(t){if(typeof t!="function")throw new TypeError(kc);return function(){var e=arguments;switch(e.length){case 0:return!t.call(this);case 1:return!t.call(this,e[0]);case 2:return!t.call(this,e[0],e[1]);case 3:return!t.call(this,e[0],e[1],e[2])}return!t.apply(this,e)}}function Lc(t,e){return e=ct(e,t),t=Fc(t,e),t==null||delete t[ut($c(e))]}function Gc(t){return D(t)?void 0:t}var Uc=1,zc=2,Vc=4,Wc=ei(function(t,e){var n={};if(t==null)return n;var r=!1;e=Vt(e,function(a){return a=ct(a,t),r||(r=a.length>1),a}),vt(t,ce(t),n),r&&(n=Rt(n,Uc|zc|Vc,Gc));for(var o=e.length;o--;)Lc(n,e[o]);return n});const zn=Wc;function Hc(t,e,n,r){if(!q(t))return t;e=ct(e,t);for(var o=-1,a=e.length,s=a-1,i=t;i!=null&&++o<a;){var c=ut(e[o]),u=n;if(c==="__proto__"||c==="constructor"||c==="prototype")return t;if(o!=s){var l=i[c];u=r?r(l,c,i):void 0,u===void 0&&(u=q(l)?l:Jt(e[o+1])?[]:{})}Yt(i,c,u),i=i[c]}return t}function Jc(t,e,n){for(var r=-1,o=e.length,a={};++r<o;){var s=e[r],i=Pt(t,s);n(i,s)&&Hc(a,ct(s,t),i)}return a}function Xc(t,e){if(t==null)return{};var n=Vt(ce(t),function(r){return[r]});return e=Un(e),Jc(t,n,function(r,o){return e(r,o[0])})}function Yc(t,e){return Xc(t,Bc(Un(e)))}const Qc=t=>({data:e,message:n,throwError:r})=>{const o=t({data:e,message:n,throwError:r});if(o.isValidate)return o;if(r)throw o.message||n?new Error(`${o.message||n}
 originData: ${JSON.stringify(e)}`):new Error(`${JSON.stringify(e)} 
 data struct format is invalidate`);return o},ve=t=>{const{data:e,message:n,throwError:r,dataStruct:o}=t;return Qc(({data:a})=>{try{return $e(a,o),{isValidate:!0}}catch(s){let i=s;return s instanceof Ie&&(i=s.failures().map(c=>`\u3010${c.path.join(".")}\u3011: ${c.message}
`)),{isValidate:!1,message:i,error:s}}})({data:e,message:n,throwError:r})};var F=(t=>(t.SLOT="SLOT",t.FUNCTION="FUNCTION",t.EXPRESSION="EXPRESSION",t))(F||{}),ye=(t=>(t.DESIGN="design",t.SAVE="save",t))(ye||{}),It=(t=>(t.FUNC="FUNC",t.COMP="COMP",t))(It||{});const qc=()=>Q("normalObj",t=>!D(t)||[F.SLOT,F.EXPRESSION,F.FUNCTION].includes(t==null?void 0:t.type)?!1:(at(t,pt(f(),me)),!0)),me=M([f(),Le(),H(),m({type:T(F.SLOT),renderType:Ut([It.FUNC,It.COMP]),params:p(P(f())),value:it(()=>M([lt,P(lt)]))}),m({type:T(F.EXPRESSION),value:f()}),m({type:T(F.FUNCTION),value:f()}),qc(),P(it(()=>me))]),Vn=m({type:T(F.EXPRESSION),value:f()}),lt=m({id:p(f()),componentName:f(),props:p(pt(f(),me)),stateName:p(f()),state:p(pt(f(),L())),children:it(()=>p(P(M([f(),lt])))),configure:p(L()),style:p(f()),className:p(f()),refId:p(f()),extra:p(pt(L(),L())),condition:p(M([H(),Vn])),loop:p(m({open:H(),data:M([P(L()),Vn]),args:p(P(f()))}))});var ge=(t=>(t.PAGE="Page",t))(ge||{});const Kc=Fe(ke(lt,["componentName"]),m({componentName:T("Page")})),be=m({package:f(),version:f(),exportName:f(),destructuring:p(H()),subName:p(f()),main:p(f())}),Zc=M([m({globName:f(),type:T(["CDN"]),content:M([be])}),m({globName:f(),type:T(["FUNCTION"]),content:M([f()])})]),tu=m({version:f(),pageName:f(),style:p(f()),css:p(f()),componentsMeta:P(Fe(m({componentName:f()}),be)),thirdLibs:p(Zc),componentsTree:Kc});function eu(t){return{all:t=t||new Map,on:function(e,n){var r=t.get(e);r?r.push(n):t.set(e,[n])},off:function(e,n){var r=t.get(e);r&&(n?r.splice(r.indexOf(n)>>>0,1):t.set(e,[]))},emit:function(e,n){var r=t.get(e);r&&r.slice().map(function(o){o(n)}),(r=t.get("*"))&&r.slice().map(function(o){o(e,n)})}}}const jt=eu(),je=M([f(),m({label:f(),tip:p(f())})]),nu=m({type:T("shape"),value:P(m({name:f(),title:je,valueType:it(()=>xt)}))}),ru=m({type:T("enums"),value:P(f())});m({type:T("array"),value:it(()=>xt)});const ou=m({type:T("array"),value:it(()=>P(xt))}),xt=M([Ut(["array","boolean","number","object","string"]),Ut(["component","expression","function"]),nu,ru,ou]),au=M([f(),m({componentName:f(),props:L(),initialValue:L()})]),_e=m({name:f(),title:je,valueType:xt,description:p(f()),defaultValue:L(),setters:p(P(au)),condition:p(Be())}),iu=M([f(),Be()]);var Oe=(t=>(t.SINGLE="single",t.GROUP="group",t))(Oe||{});M([f(),m({name:f(),describe:p(f()),params:p(m({name:f(),description:f()})),template:f()})]);const su=m({componentName:f(),title:je,description:p(f()),screenshot:p(f()),icon:p(f()),tags:p(P(f())),groupTag:p(f()),category:p(f()),priority:p(Le()),version:f(),npm:be,snippets:P(ke(lt,["id"])),props:P(M([_e,m({type:T("single"),content:_e}),m({type:T("group"),content:P(_e)})])),isContainer:p(H()),isModal:p(M([H(),m({visibleKey:f()})])),isSupportStyle:p(H()),isSupportDispatchNativeEvent:p(H()),isLayout:p(H()),rootSelector:p(f()),selectionToolBars:p(P(iu)),extra:p(pt(L(),L()))}),cu=(t,e)=>{const n={...t,value:[]},r=t.value;return r&&(N(r)?n.value=r.map(o=>new _(o)):D(r)&&n.value.push(new _(r,{parent:e}))),n};class ot{constructor(e,{parent:n}){h(this,"nodeType","SLOT"),h(this,"rawData"),h(this,"parent"),h(this,"emitter",jt),h(this,"data"),h(this,"id"),this.parent=n,this.rawData=e,this.data=cu(e,this),this.id=_t()}get value(){return this.data}export(e){const n=this.data,r=o=>{if(o instanceof _)return o.export(e);if(D(o)){const a={};return Object.keys(o||{}).forEach(s=>{a[s]=r(o[s])}),a}return N(o)?o.map(a=>r(a)):(e==="design"&&delete o.id,o)};return r(n)}}const Wn=t=>{let e=[];return t.forEach(n=>{const r=n;r.type?r.type===Oe.SINGLE?e.push(r.content):r.type===Oe.GROUP&&(e=[...e,...Wn(r.content)]):e.push(n)}),e},we=(t,e,n)=>{if(t.type)return t.type===F.SLOT?new ot(t,{parent:e,materials:n}):t;if(D(t)){const r={};return Object.keys(t).forEach(o=>{r[o]=Ce(t[o],e)}),r}else return Array.isArray(t)?t.map(r=>we(r,e,n)):t},Ce=(t,e,n)=>D(t)?we(t,e,n):N(t)?t.map(r=>we(r,e,n)):t;class ft{constructor(e,n,{parent:r,materials:o}){h(this,"nodeType","PROP"),h(this,"rawData"),h(this,"parent"),h(this,"emitter",jt),h(this,"data"),h(this,"name"),h(this,"materialsMode"),this.materialsMode=o,this.parent=r,this.rawData=n,this.name=e,this.data=Ce(n,this,o)}isIncludeSlot(){return!1}isIncludeExpression(){return!1}get value(){return this.data}updateValue(e){const n=this.data;this.data=Ce(e!=null?e:n,this),this.emitter.emit("onPropChange",{value:this.data,preValue:n,node:this}),this.parent&&!(this.parent instanceof ot)&&this.emitter.emit("onNodeChange",{value:this.parent.value,preValue:this.parent.value,node:this.parent})}get material(){const e=this.parent;if(e instanceof _){const n=e.material;return Wn((n==null?void 0:n.value.props)||[]).find(r=>r.name===this.name)}else return null}export(e){const n=this.data,r=o=>{if(o instanceof ot||o instanceof _)return o.export(e);if(D(o)){const a={};return Object.keys(o||{}).forEach(s=>{a[s]=r(o[s])}),a}return N(o)?o.map(a=>r(a)):(e==="design"&&delete o.id,o)};return r(n)}}const uu=t=>{if(typeof t=="string")return!0;ve({data:t,dataStruct:lt,throwError:!0})},Hn=(t,e,n)=>{var r;if(typeof t=="string")return t;const o={...t,id:(r=t.id)!=null?r:_t(),children:[],props:{}},a=Object.keys(t.props||{});return a.length&&a.forEach(s=>{var i;o.props[s]instanceof ft||(o.props[s]=new ft(s,((i=t.props)==null?void 0:i[s])||"",{parent:e,materials:n}))}),t.children&&(Array.isArray(t.children)?o.children=t.children.map(s=>{if(s instanceof _)return s;if(D(s)){const i=s;return new _(i,{parent:e,materials:n})}else return s}):(t.children instanceof _&&(o.children=[t.children]),o.children=[new _(t.children,{parent:e,materials:n})])),o};class _{constructor(e,n){h(this,"nodeType","NODE"),h(this,"rawData"),h(this,"data"),h(this,"emitter",jt),h(this,"parent"),h(this,"materialsModel"),h(this,"listenerHandle"),h(this,"onChangeCbQueue"),this.rawData=JSON.parse(JSON.stringify(e)),uu(e),this.parent=(n==null?void 0:n.parent)||null,this.materialsModel=(n==null?void 0:n.materials)||null,this.data=Hn(e,this,n==null?void 0:n.materials),this.listenerHandle=[],this.onChangeCbQueue=[],this.registerListener()}registerListener(){const e=n=>{const{node:r}=n;r===this&&r.id===this.id&&this.onChangeCbQueue.forEach(o=>o(n))};this.emitter.on("onNodeChange",e),this.listenerHandle.push(()=>{this.emitter.off("onNodeChange",e)})}onChange(e){return this.onChangeCbQueue.push(e),()=>{this.onChangeCbQueue=this.onChangeCbQueue.filter(n=>n!==e)}}destroy(){this.listenerHandle.forEach(e=>e())}get id(){return this.data.id}get value(){return this.data}clone(e){const n={...this.export("design"),id:e||_t()};return new _(n)}updateValue(e){const n=this.data,r={...this.data,...e};this.data=Hn(r,this),this.emitter.emit("onNodeChange",{value:r,preValue:n,node:this})}get props(){return this.data.props}get material(){const e=this.materialsModel;return e==null?void 0:e.findByComponentName(this.data.componentName)}export(e){var n;const r=this.data;if(typeof r=="string")return r;const o={};Object.keys(r.props||{}).forEach(i=>{o[i]=r.props[i].export(e)});const a=(n=r.children)==null?void 0:n.map(i=>i instanceof _?i.export(e):i);let s={...r,props:o,children:a};return e==="design"&&delete s.id,s=Ee(s),s}}const Jn=t=>(t==null?void 0:t.type)===F.EXPRESSION,lu=t=>(t==null?void 0:t.type)==F.FUNCTION,_t=()=>Math.random().toString(32).slice(3,9),Xn=t=>(t==null?void 0:t.nodeType)==="PROP"&&t instanceof ft,Ee=t=>Yc(t,e=>D(e)?!Object.keys(e).length:N(e)?!e.length:!e),Yn=(t,e,n)=>{const r={...t,id:_t(),props:{},componentName:ge.PAGE,children:[]};let o=[];N(t.children)?o=t.children.map(s=>s instanceof _?s:D(s)?new _(s,{parent:e,materials:n}):s):t.children instanceof _?o.push(t.children):t.children&&D(t.children)?o.push(new _(t.children,{parent:e})):o.push(t.children,{parent:e});const a=Object.keys(t.props||{});return a.length&&a.forEach(s=>{var i;r.props[s]=new ft(s,((i=t.props)==null?void 0:i[s])||"",{parent:e})}),r.children=o,r};class Ne{constructor(e,{parent:n,materials:r}){h(this,"rawData"),h(this,"data"),h(this,"nodeType","SCHEMA"),h(this,"emitter",jt),h(this,"materialsModel"),h(this,"listenerHandle"),h(this,"onChangeCbQueue"),h(this,"parent"),this.materialsModel=r,this.rawData=JSON.parse(JSON.stringify(e)),this.data=Yn(e,this,r),this.listenerHandle=[],this.onChangeCbQueue=[],this.registerListener(),this.parent=n}registerListener(){const e=n=>{const{node:r}=n;r===this&&r.id===this.id&&this.onChangeCbQueue.forEach(o=>o(n))};this.emitter.on("onNodeChange",e),this.listenerHandle.push(()=>{this.emitter.off("onNodeChange",e)})}onChange(e){return this.onChangeCbQueue.push(e),()=>{this.onChangeCbQueue=this.onChangeCbQueue.filter(n=>n!==e)}}get id(){return this.data.id}get value(){return this.data}get props(){return this.data.props}get material(){const e=this.materialsModel;return e==null?void 0:e.findByComponentName(this.data.componentName)}updateValue(e){const n=this.data,r={...this.data,...e};this.data=Yn(r,this,this.materialsModel),this.emitter.emit("onNodeChange",{value:this.data,preValue:n,node:this})}export(e=ye.SAVE){var n;const r=this.data,o={};Object.keys(r.props||{}).forEach(c=>{o[c]=r.props[c].export(e)});const a=(n=r.children)==null?void 0:n.map(c=>c.export(e)),s={...r,props:o,children:a};let i=zn(s,["id"]);return i=Ee(i),i}}const fu=t=>t;class du{constructor(e){h(this,"rawData"),h(this,"data"),this.rawData=e,this.data=fu(e)}get value(){return this.data}get componentName(){return this.data.componentName}}const pu=t=>{if(!N(t))throw new Error("Materials must be a array");return t.map(e=>new du(e))},hu=t=>{t==null||t.forEach(e=>{ve({data:e,dataStruct:su,throwError:!0})})};class vu{constructor(e){h(this,"rowData"),h(this,"data"),this.rowData=e,hu(e),this.data=pu(e)}findByComponentName(e){return this.data.find(n=>n.componentName===e)}get value(){return this.data}}const yu=t=>(ve({data:t,dataStruct:tu,throwError:!0}),t),mu=(t,e,n)=>({...t,componentsTree:new Ne(t.componentsTree,{parent:e,materials:n})});class Se{constructor(e,n){h(this,"nodeType","PAGE"),h(this,"rawData"),h(this,"emitter",jt),h(this,"data"),h(this,"parent"),h(this,"materialsModel"),yu(e),this.rawData=JSON.parse(JSON.stringify(e)),this.materialsModel=new vu((n==null?void 0:n.materials)||[]),this.data=mu(e,this,this.materialsModel)}get value(){return this.data}getNode(e){const n=[this.data.componentsTree];for(;n.length;){const r=n.shift();if((r==null?void 0:r.id)===e)return r;const o=(r==null?void 0:r.props)||{},a=i=>{if(i instanceof _){n.push(i);return}if(i instanceof ot&&a(i.value.value),i instanceof ft){a(i.value);return}if(D(i)){const c=i;Object.keys(c).map(u=>{a(c[u])});return}if(N(i)){i.forEach(c=>{a(c)});return}};a(o);const s=(r==null?void 0:r.value.children.filter(i=>i instanceof _))||[];n.push(...s)}return null}addNode(e,n,r="AFTER"){var o,a,s;if(r==="AFTER"||r==="BEFORE"){const i=n.parent;if(i===null&&n instanceof Ne)throw new Error("Not found parent node");if(i instanceof ft){console.log("CProp can not add node");return}if(i instanceof ot){const u=i.value.value,l=(o=u.findIndex(d=>d===n))!=null?o:-1;return l>=0?(r==="BEFORE"?u.splice(l,0,e):u.splice(l+1,0,e),e.parent=i,(a=i.parent)==null||a.updateValue(),!0):void 0}if(i instanceof Se)return;const c=(s=i==null?void 0:i.value.children.findIndex(u=>u===n))!=null?s:-1;if(c>=0)return r==="BEFORE"?i==null||i.value.children.splice(c,0,e):i==null||i.value.children.splice(c+1,0,e),e.parent=i,i==null||i.updateValue(),!0;console.warn("Not found target node");return}if(r==="CHILD_START")return n.value.children.unshift(e),e.parent=n,n.updateValue(),!0;if(r==="CHILD_END")return n.value.children.push(e),e.parent=n,n.updateValue(),!0;if(D(r)){const i=r;if(i.type==="CHILD"){const c=i.pos,u=i.index||0;return c==="BEFORE"?n==null||n.value.children.splice(u,0,e):n==null||n.value.children.splice(u+1,0,e),e.parent=n,n.updateValue(),!0}else console.warn("Can not parse pos obj")}return!1}createNode(e){return delete e.id,new _(e,{parent:null})}addNodeById(e,n,r="AFTER"){const o=this.getNode(n);return o?this.addNode(e,o,r):(console.warn(`Not find a node by ${n}, pls check it`),!1)}copyNode(e){const n=e.export("design");n.id=_t();const r=new _(n,{parent:e.parent});return this.addNode(r,e,"AFTER"),r}copyNodeById(e){const n=this.getNode(e);return n&&n instanceof _?this.copyNode(n):!1}moveNode(e,n,r){this.deleteNode(e);let o=n;["AFTER","BEFORE"].includes(r)&&(o=n.parent),e.parent=o,this.addNode(e,n,r)}moveNodeById(e,n,r){const o=this.getNode(e),a=this.getNode(n);return o&&a&&o instanceof _&&a instanceof _?this.moveNode(o,a,r):!1}deleteNode(e){var n;const r=e.parent;if(!r)throw new Error("parent node is null or undefined, pls check it");if(r instanceof ot){const o=r.value.value,a=o.findIndex(i=>i===e),s=o[a];return o.splice(a,1),(n=r.parent)==null||n.updateValue(),s}if(r instanceof _||r instanceof Ne){const o=r.value.children,a=o.findIndex(i=>i===e),s=o[a];return o.splice(a,1),r.updateValue(),s}}deleteNodeById(e){const n=this.getNode(e);if(n)return this.deleteNode(n)}export(e=ye.SAVE){let n={...this.data,componentsTree:this.data.componentsTree.export(e)};return n=zn(n,["id"]),n=Ee(n),JSON.parse(JSON.stringify(n))}}const Qn=t=>new Se(t);var gu=typeof global=="object"&&global&&global.Object===Object&&global;const bu=gu;var ju=typeof self=="object"&&self&&self.Object===Object&&self,_u=bu||ju||Function("return this")(),Ou=_u.Symbol;const $t=Ou;var qn=Object.prototype,wu=qn.hasOwnProperty,Cu=qn.toString,Ot=$t?$t.toStringTag:void 0;function Eu(t){var e=wu.call(t,Ot),n=t[Ot];try{t[Ot]=void 0;var r=!0}catch{}var o=Cu.call(t);return r&&(e?t[Ot]=n:delete t[Ot]),o}var Nu=Object.prototype,Su=Nu.toString;function Au(t){return Su.call(t)}var Pu="[object Null]",Mu="[object Undefined]",Kn=$t?$t.toStringTag:void 0;function Ru(t){return t==null?t===void 0?Mu:Pu:Kn&&Kn in Object(t)?Eu(t):Au(t)}function Tu(t){return t!=null&&typeof t=="object"}var Du=Array.isArray;const Iu=Du;function xu(t,e){return function(n){return t(e(n))}}var $u=xu(Object.getPrototypeOf,Object);const Fu=$u;var ku="[object Object]",Bu=Function.prototype,Lu=Object.prototype,Zn=Bu.toString,Gu=Lu.hasOwnProperty,Uu=Zn.call(Object);function zu(t){if(!Tu(t)||Ru(t)!=ku)return!1;var e=Fu(t);if(e===null)return!0;var n=Gu.call(e,"constructor")&&e.constructor;return typeof n=="function"&&n instanceof n&&Zn.call(n)==Uu}function Vu(t){var r,o;const n=typeof Symbol=="function"&&Symbol.for?Symbol.for("react.forward_ref"):60112;return(t==null?void 0:t.$$typeof)===n||((r=t==null?void 0:t.prototype)==null?void 0:r.isReactComponent)||((o=t==null?void 0:t.prototype)==null?void 0:o.setState)||t._forwardRef}function Wu(t){class e extends A.Component{render(){return A.createElement(t,this.props)}}return e.displayName=t.displayName,e}const Ae=(t,e)=>{const n=r=>{const a=`
    ${Object.keys(e).map(s=>`const ${s} = $$context['${s}'];`).join(`
`)}
    return ${r};
    `;return new Function("$$context",a)(e)};try{return n(t)}catch(r){return console.warn(r),`[${t}] expression run failed`}},Hu=(t,e)=>function(...r){try{const o=`
        var f = ${t};
        return f.apply(f, arguments)
      `;new Function(o)(...r,e)}catch(o){console.warn(o)}},tr=(t,e)=>{const n={};return e.forEach((r,o)=>{n[r]=t[o]}),n},Ft="DYNAMIC",Ju=["$$context","$$nodeModel"],z=new Map;class Xu{constructor(){w(this,"components",{});w(this,"onGetRef");w(this,"onGetComponent");w(this,"onComponentMount");w(this,"onComponentDestroy")}getComponent(e){var o;const n=e.value.componentName;let r=this.components[n]||(()=>"Component not found");return Vu(r)||(r=Wu(r),this.components[n]=r),this.onGetComponent&&(r=(o=this.onGetComponent)==null?void 0:o.call(this,r,e)),r}getContext(e={},n){let r=e;return n&&(r={...e},r.__proto__=n||null),r}pageRender(e,{components:n,onGetRef:r,$$context:o={},onGetComponent:a,onComponentMount:s,onComponentDestroy:i}){this.components=n,this.onGetRef=r,this.onGetComponent=a,this.onComponentMount=s,this.onComponentDestroy=i;const c=e.value.componentsTree,u=this.getComponent(c),l=this.convertModelToComponent(u,e.value.componentsTree),d={},v=c.props;return Object.keys(v).forEach(g=>{d[g]=v[g].value}),d.$$context=o,this.render(l,d)}transformProps(e={},{$$context:n}){const r=e,o=s=>{if(Array.isArray(s))return s.map(i=>o(i));if(Xn(s))return o(s.value);if(s instanceof ot){const i=s.value,c=i.value;if(!c)return console.warn("slot value is null, this maybe cause some error, pls check it",e),()=>{};const u=l=>{if(z.get(l.id))return z.get(l.id);const d=this.getComponent(l),v=this.convertModelToComponent(d,l);if(i.renderType===It.FUNC){const g=i.params||[],C=(...S)=>{const O=tr(S,g),E=this.getContext({params:O},n),I=`${l.id}-${Ft}`;return this.render(v,{$$context:E,key:I})};return z.set(l.id,C),C}else return z.set(l.id,v),v};if(Array.isArray(c)){const l=c==null?void 0:c.map(d=>u(d));return(...d)=>l.map(v=>v(...d))}else return u(c)}else{if(Jn(s))return Ae(s.value,n||{});if(lu(s))return Hu(s.value,n);if(zu(s)){let i=s;Xn(s)&&(i=s.value);const c=i,u={};return Object.keys(i).forEach(l=>{u[l]=o(c[l])}),u}else return s}},a={};return Object.keys(r).forEach(s=>{const i=r[s];a[s]=o(i)}),a}convertModelToComponent(e,n){const r=this;class o extends W.default.Component{constructor(i){super(i);w(this,"NODE_ID",n.id);w(this,"targetComponentRef");w(this,"listenerHandle",[]);w(this,"updateState",i=>{this.setState(i)});this.targetComponentRef=W.default.createRef(),this.state=n.value.state||{}}componentDidMount(){var c;r.onGetRef&&r.onGetRef(this.targetComponentRef,n,this),(c=r.onComponentMount)==null||c.call(r,this,n);const i=()=>{this.forceUpdate()};n.onChange(i)}componentWillUnmount(){var i;(i=r.onComponentDestroy)==null||i.call(r,this,n)}render(){var wt;const{$$context:i,...c}=this.props,u={key:n.id,...n.props,...c},l={state:this.state||{},updateState:this.updateState};n.value.componentName===ge.PAGE&&(l.globalState=this.state,l.updateGlobalState=this.updateState,l.stateManager={});const d=r.getContext(l,i),v=n.value.stateName;n.value.stateName&&typeof v=="string"&&d.stateManager&&(d.stateManager[v]={state:this.state||{},updateState:this.updateState});let g=(wt=n.value.condition)!=null?wt:!0;if(typeof g!="boolean"&&(g=Ae(g.value,d||{})),!g)return null;const C=n.value.loop;let S=[];if(C&&C.open){this.targetComponentRef.current=[];let k=[];if(Jn(C.data)){const V=C.data;k=Ae(V.value,d||{})}return S=k.map((...V)=>{const kt=V[1],Pe=C.args||["item","index"],Me=tr(V,Pe),tl=r.getContext({loopData:Me},d),dt=r.transformProps(u,{$$context:tl}),{children:Bt}=dt;let Re=[];if(Bt!==void 0)delete dt.children,Re=Array.isArray(Bt)?Bt:[Bt];else{const Lt=[];n.value.children.forEach((el,nl)=>{const rl=r.buildComponent(el,{$$context:d,idx:nl});Lt.push(rl)}),Re=Lt}return dt.key=`${dt.key}-${kt}`,dt.ref=Lt=>{this.targetComponentRef.current[kt]=Lt},r.render(e,dt,...Re)}),S}const O=r.transformProps(u,{$$context:d}),{children:E}=O;let I=[];if(E!==void 0)delete O.children,I=Array.isArray(E)?E:[E];else{const k=[];n.value.children.forEach((kt,Pe)=>{const Me=r.buildComponent(kt,{$$context:d,idx:Pe});k.push(Me)}),I=k}return O.ref=this.targetComponentRef,r.render(e,O,...I)}}return w(o,"__CP_TYPE__",Ft),o}buildComponent(e,{$$context:n={}}){return typeof e=="string"?this.render(e):(({currentNode:o})=>{const a=o.value.id;let s=null;if(z.get(a))s=z.get(a);else{const u=this.getComponent(o);s=this.convertModelToComponent(u,o)}z.get(a)||z.set(a,s);const i=`${a}-${Ft}`,c={$$context:n,$$nodeModel:e,key:i};return this.render(s,c)})({currentNode:e})}render(e,n={},...r){return typeof e=="string"||typeof e=="number"?String(e):(Ju.forEach(a=>{a in n&&e.__CP_TYPE__!==Ft&&delete n[a]}),W.default.createElement(e,n,...r))}}const Yu=De(new Xu);class Qu{constructor(){w(this,"refMap",new Map)}get(e){return this.refMap.get(e).current}add(e,n){this.refMap.set(e,n)}remove(e){this.refMap.delete(e)}destroy(){this.refMap.clear()}}class er extends W.default.Component{constructor(n){super(n);w(this,"refManager");w(this,"rerender",n=>{var r;z.clear(),this.setState({pageModel:Qn(n)}),(r=this.state.pageModel)==null||r.emitter.emit("onNodeChange",{value:n,preValue:this.state.pageModel,node:this.state.pageModel})});w(this,"onGetRef",(n,r,o)=>{var a,s;(s=(a=this.props).onGetRef)==null||s.call(a,n,r,o),this.refManager.add(r.value.refId||r.id,n)});this.state={pageModel:n.pageModel||Qn(n.page)},this.refManager=new Qu}componentDidMount(){const{render:n}=this.props;n&&(n.ref.current=this)}componentWillUnmount(){this.refManager.destroy()}render(){const{props:n}=this,{adapter:r,onGetComponent:o,onComponentDestroy:a,onComponentMount:s}=n,{pageModel:i}=this.state;return i?r.pageRender(i,{libs:{},components:n.components||{},onGetRef:this.onGetRef,onGetComponent:o,onComponentMount:s,onComponentDestroy:a,$$context:{refs:this.refManager}}):null}}const qu=()=>{const t=A.useRef(null);return{ref:t,rerender:function(...e){t.current&&t.current.rerender(...e)}}};class nr{constructor(){w(this,"instanceMap",new Map)}get(e){return this.instanceMap.get(e)}add(e,n){this.instanceMap.set(e,n)}remove(e){this.instanceMap.delete(e)}destroy(){this.instanceMap.clear()}}class Ku extends W.default.Component{constructor(n){super(n);w(this,"instanceManager",new nr);w(this,"renderRef");w(this,"onGetComponent",(n,r)=>{class o extends W.default.Component{constructor(){super(...arguments);w(this,"_DESIGN_BOX",!0);w(this,"_NODE_MODEL",r);w(this,"_NODE_ID",r.id)}render(){const{children:i=[],...c}=this.props;let u=i;return Iu(i)||(u=[i]),W.default.createElement(n,c,...u)}}return o});w(this,"onComponentMount",(n,r)=>{this.instanceManager.add(r.id,n)});w(this,"onComponentDestroy",(n,r)=>{this.instanceManager.remove(r.id)});this.renderRef=W.default.createRef()}rerender(n){var r;return(r=this.renderRef.current)==null?void 0:r.rerender(n)}getInstanceById(n){return this.instanceManager.get(n)}getInstanceByDom(n){const r=rr(n);if(!r)return null;const o=or(r);return(o==null?void 0:o.stateNode)||null}getDomById(n,r){const o=this.getInstanceById(n),a=sr.findDOMNode(o);return r&&a&&!(a instanceof Text)?Array.from(a.querySelectorAll(r)):[a]}getDomRectById(n,r){return this.getDomById(n,r).map(s=>s==null?void 0:s.getBoundingClientRect()).filter(Boolean)}render(){const{props:n,onGetComponent:r,onComponentDestroy:o,onComponentMount:a}=this;return W.default.createElement(er,{onGetComponent:r,onComponentMount:a,onComponentDestroy:o,...n,ref:this.renderRef})}}const rr=t=>{if(!t)return null;const e=Object.keys(t).find(n=>n.startsWith("__reactInternalInstance$")||n.startsWith("__reactFiber$"))||"";return e?t[e]:rr(t.parentElement)},or=t=>{var e;return t?(e=t==null?void 0:t.stateNode)!=null&&e._DESIGN_BOX?t:or(t.return):null},Zu=()=>{const t=A.useRef(null);return{ref:t,rerender:function(...e){t.current&&t.current.rerender(...e)},getInstanceById(e){var n;return(n=t.current)==null?void 0:n.getInstanceById(e)},getInstanceByDom(e){var n;return(n=t.current)==null?void 0:n.getInstanceByDom(e)},getDomById(e,n){var r;return((r=t.current)==null?void 0:r.getDomById(e,n))||[]},getDomRectById(e,n){var r;return((r=t.current)==null?void 0:r.getDomRectById(e,n))||[]}}};y.ComponentInstanceManager=nr,y.DesignRender=Ku,y.ReactAdapter=Yu,y.Render=er,y.getAdapter=De,y.runtimeComponentCache=z,y.useDesignRender=Zu,y.useRender=qu,Object.defineProperties(y,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
