(function(_,R){typeof exports=="object"&&typeof module<"u"?R(exports,require("react"),require("react-dom")):typeof define=="function"&&define.amd?define(["exports","react","react-dom"],R):(_=typeof globalThis<"u"?globalThis:_||self,R(_.CRender={},_.React,_.ReactDOM))})(this,function(_,R,nt){"use strict";var bf=Object.defineProperty;var jf=(_,R,nt)=>R in _?bf(_,R,{enumerable:!0,configurable:!0,writable:!0,value:nt}):_[R]=nt;var b=(_,R,nt)=>(jf(_,typeof R!="symbol"?R+"":R,nt),nt);const Rn=t=>t&&typeof t=="object"&&"default"in t?t:{default:t};function Pn(t){if(t&&t.__esModule)return t;const e=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(t){for(const r in t)if(r!=="default"){const n=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(e,r,n.get?n:{enumerable:!0,get:()=>t[r]})}}return e.default=t,Object.freeze(e)}const A=Rn(R),Dn=Pn(nt),In=t=>()=>{console.warn(`${t} need to be implement getComponent`)},kn=["customPageRootRender"],Ve=["pageRender","render","convertModelToComponent","getComponent","getContext","getUtils","getDataLink","createDataLink","transformProps","transformData","transformGlobalData","errorCatch","clear"],We=t=>[...Ve,...kn].reduce((r,n)=>{var o;return t!=null&&t[n]?r[n]=(o=t[n])==null?void 0:o.bind(t):Ve.includes(n)&&(r[n]=In),r},{});var Fn=Object.defineProperty,Ln=(t,e,r)=>e in t?Fn(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,g=(t,e,r)=>(Ln(t,typeof e!="symbol"?e+"":e,r),r),Bn=typeof global=="object"&&global&&global.Object===Object&&global;const He=Bn;var Un=typeof self=="object"&&self&&self.Object===Object&&self,Gn=He||Un||Function("return this")();const W=Gn;var zn=W.Symbol;const G=zn;var Je=Object.prototype,Vn=Je.hasOwnProperty,Wn=Je.toString,_t=G?G.toStringTag:void 0;function Hn(t){var e=Vn.call(t,_t),r=t[_t];try{t[_t]=void 0;var n=!0}catch{}var o=Wn.call(t);return n&&(e?t[_t]=r:delete t[_t]),o}var Jn=Object.prototype,Qn=Jn.toString;function Yn(t){return Qn.call(t)}var qn="[object Null]",Xn="[object Undefined]",Qe=G?G.toStringTag:void 0;function ot(t){return t==null?t===void 0?Xn:qn:Qe&&Qe in Object(t)?Hn(t):Yn(t)}function Q(t){return t!=null&&typeof t=="object"}var Kn="[object Symbol]";function Qt(t){return typeof t=="symbol"||Q(t)&&ot(t)==Kn}function Yt(t,e){for(var r=-1,n=t==null?0:t.length,o=Array(n);++r<n;)o[r]=e(t[r],r,t);return o}var Zn=Array.isArray;const T=Zn;var to=1/0,Ye=G?G.prototype:void 0,qe=Ye?Ye.toString:void 0;function Xe(t){if(typeof t=="string")return t;if(T(t))return Yt(t,Xe)+"";if(Qt(t))return qe?qe.call(t):"";var e=t+"";return e=="0"&&1/t==-to?"-0":e}function Z(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}function Ke(t){return t}var eo="[object AsyncFunction]",ro="[object Function]",no="[object GeneratorFunction]",oo="[object Proxy]";function Ze(t){if(!Z(t))return!1;var e=ot(t);return e==ro||e==no||e==eo||e==oo}var ao=W["__core-js_shared__"];const qt=ao;var tr=function(){var t=/[^.]+$/.exec(qt&&qt.keys&&qt.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();function io(t){return!!tr&&tr in t}var so=Function.prototype,co=so.toString;function at(t){if(t!=null){try{return co.call(t)}catch{}try{return t+""}catch{}}return""}var uo=/[\\^$.*+?()[\]{}|]/g,lo=/^\[object .+?Constructor\]$/,fo=Function.prototype,po=Object.prototype,ho=fo.toString,mo=po.hasOwnProperty,vo=RegExp("^"+ho.call(mo).replace(uo,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function yo(t){if(!Z(t)||io(t))return!1;var e=Ze(t)?vo:lo;return e.test(at(t))}function go(t,e){return t==null?void 0:t[e]}function it(t,e){var r=go(t,e);return yo(r)?r:void 0}var bo=it(W,"WeakMap");const Xt=bo;var er=Object.create,jo=function(){function t(){}return function(e){if(!Z(e))return{};if(er)return er(e);t.prototype=e;var r=new t;return t.prototype=void 0,r}}();const _o=jo;function wo(t,e,r){switch(r.length){case 0:return t.call(e);case 1:return t.call(e,r[0]);case 2:return t.call(e,r[0],r[1]);case 3:return t.call(e,r[0],r[1],r[2])}return t.apply(e,r)}function So(t,e){var r=-1,n=t.length;for(e||(e=Array(n));++r<n;)e[r]=t[r];return e}var Oo=800,Co=16,Eo=Date.now;function No(t){var e=0,r=0;return function(){var n=Eo(),o=Co-(n-r);if(r=n,o>0){if(++e>=Oo)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}function Mo(t){return function(){return t}}var $o=function(){try{var t=it(Object,"defineProperty");return t({},"",{}),t}catch{}}();const xt=$o;var Ao=xt?function(t,e){return xt(t,"toString",{configurable:!0,enumerable:!1,value:Mo(e),writable:!0})}:Ke,xo=No(Ao);const To=xo;function Ro(t,e){for(var r=-1,n=t==null?0:t.length;++r<n&&e(t[r],r,t)!==!1;);return t}var Po=9007199254740991,Do=/^(?:0|[1-9]\d*)$/;function Kt(t,e){var r=typeof t;return e=e==null?Po:e,!!e&&(r=="number"||r!="symbol"&&Do.test(t))&&t>-1&&t%1==0&&t<e}function rr(t,e,r){e=="__proto__"&&xt?xt(t,e,{configurable:!0,enumerable:!0,value:r,writable:!0}):t[e]=r}function Zt(t,e){return t===e||t!==t&&e!==e}var Io=Object.prototype,ko=Io.hasOwnProperty;function te(t,e,r){var n=t[e];(!(ko.call(t,e)&&Zt(n,r))||r===void 0&&!(e in t))&&rr(t,e,r)}function wt(t,e,r,n){var o=!r;r||(r={});for(var a=-1,i=e.length;++a<i;){var s=e[a],c=n?n(r[s],t[s],s,r,t):void 0;c===void 0&&(c=t[s]),o?rr(r,s,c):te(r,s,c)}return r}var nr=Math.max;function Fo(t,e,r){return e=nr(e===void 0?t.length-1:e,0),function(){for(var n=arguments,o=-1,a=nr(n.length-e,0),i=Array(a);++o<a;)i[o]=n[e+o];o=-1;for(var s=Array(e+1);++o<e;)s[o]=n[o];return s[e]=r(i),wo(t,this,s)}}var Lo=9007199254740991;function ee(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=Lo}function or(t){return t!=null&&ee(t.length)&&!Ze(t)}var Bo=Object.prototype;function re(t){var e=t&&t.constructor,r=typeof e=="function"&&e.prototype||Bo;return t===r}function Uo(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n}var Go="[object Arguments]";function ar(t){return Q(t)&&ot(t)==Go}var ir=Object.prototype,zo=ir.hasOwnProperty,Vo=ir.propertyIsEnumerable,Wo=ar(function(){return arguments}())?ar:function(t){return Q(t)&&zo.call(t,"callee")&&!Vo.call(t,"callee")};const ne=Wo;function Ho(){return!1}var sr=typeof _=="object"&&_&&!_.nodeType&&_,cr=sr&&typeof module=="object"&&module&&!module.nodeType&&module,Jo=cr&&cr.exports===sr,ur=Jo?W.Buffer:void 0,Qo=ur?ur.isBuffer:void 0,Yo=Qo||Ho;const Tt=Yo;var qo="[object Arguments]",Xo="[object Array]",Ko="[object Boolean]",Zo="[object Date]",ta="[object Error]",ea="[object Function]",ra="[object Map]",na="[object Number]",oa="[object Object]",aa="[object RegExp]",ia="[object Set]",sa="[object String]",ca="[object WeakMap]",ua="[object ArrayBuffer]",la="[object DataView]",fa="[object Float32Array]",pa="[object Float64Array]",da="[object Int8Array]",ha="[object Int16Array]",ma="[object Int32Array]",va="[object Uint8Array]",ya="[object Uint8ClampedArray]",ga="[object Uint16Array]",ba="[object Uint32Array]",E={};E[fa]=E[pa]=E[da]=E[ha]=E[ma]=E[va]=E[ya]=E[ga]=E[ba]=!0,E[qo]=E[Xo]=E[ua]=E[Ko]=E[la]=E[Zo]=E[ta]=E[ea]=E[ra]=E[na]=E[oa]=E[aa]=E[ia]=E[sa]=E[ca]=!1;function ja(t){return Q(t)&&ee(t.length)&&!!E[ot(t)]}function oe(t){return function(e){return t(e)}}var lr=typeof _=="object"&&_&&!_.nodeType&&_,St=lr&&typeof module=="object"&&module&&!module.nodeType&&module,_a=St&&St.exports===lr,ae=_a&&He.process,wa=function(){try{var t=St&&St.require&&St.require("util").types;return t||ae&&ae.binding&&ae.binding("util")}catch{}}();const ft=wa;var fr=ft&&ft.isTypedArray,Sa=fr?oe(fr):ja;const pr=Sa;var Oa=Object.prototype,Ca=Oa.hasOwnProperty;function dr(t,e){var r=T(t),n=!r&&ne(t),o=!r&&!n&&Tt(t),a=!r&&!n&&!o&&pr(t),i=r||n||o||a,s=i?Uo(t.length,String):[],c=s.length;for(var u in t)(e||Ca.call(t,u))&&!(i&&(u=="length"||o&&(u=="offset"||u=="parent")||a&&(u=="buffer"||u=="byteLength"||u=="byteOffset")||Kt(u,c)))&&s.push(u);return s}function hr(t,e){return function(r){return t(e(r))}}var Ea=hr(Object.keys,Object);const Na=Ea;var Ma=Object.prototype,$a=Ma.hasOwnProperty;function Aa(t){if(!re(t))return Na(t);var e=[];for(var r in Object(t))$a.call(t,r)&&r!="constructor"&&e.push(r);return e}function Rt(t){return or(t)?dr(t):Aa(t)}function xa(t){var e=[];if(t!=null)for(var r in Object(t))e.push(r);return e}var Ta=Object.prototype,Ra=Ta.hasOwnProperty;function Pa(t){if(!Z(t))return xa(t);var e=re(t),r=[];for(var n in t)n=="constructor"&&(e||!Ra.call(t,n))||r.push(n);return r}function ie(t){return or(t)?dr(t,!0):Pa(t)}var Da=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Ia=/^\w*$/;function se(t,e){if(T(t))return!1;var r=typeof t;return r=="number"||r=="symbol"||r=="boolean"||t==null||Qt(t)?!0:Ia.test(t)||!Da.test(t)||e!=null&&t in Object(e)}var ka=it(Object,"create");const Ot=ka;function Fa(){this.__data__=Ot?Ot(null):{},this.size=0}function La(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}var Ba="__lodash_hash_undefined__",Ua=Object.prototype,Ga=Ua.hasOwnProperty;function za(t){var e=this.__data__;if(Ot){var r=e[t];return r===Ba?void 0:r}return Ga.call(e,t)?e[t]:void 0}var Va=Object.prototype,Wa=Va.hasOwnProperty;function Ha(t){var e=this.__data__;return Ot?e[t]!==void 0:Wa.call(e,t)}var Ja="__lodash_hash_undefined__";function Qa(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=Ot&&e===void 0?Ja:e,this}function st(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}st.prototype.clear=Fa,st.prototype.delete=La,st.prototype.get=za,st.prototype.has=Ha,st.prototype.set=Qa;function Ya(){this.__data__=[],this.size=0}function Pt(t,e){for(var r=t.length;r--;)if(Zt(t[r][0],e))return r;return-1}var qa=Array.prototype,Xa=qa.splice;function Ka(t){var e=this.__data__,r=Pt(e,t);if(r<0)return!1;var n=e.length-1;return r==n?e.pop():Xa.call(e,r,1),--this.size,!0}function Za(t){var e=this.__data__,r=Pt(e,t);return r<0?void 0:e[r][1]}function ti(t){return Pt(this.__data__,t)>-1}function ei(t,e){var r=this.__data__,n=Pt(r,t);return n<0?(++this.size,r.push([t,e])):r[n][1]=e,this}function Y(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}Y.prototype.clear=Ya,Y.prototype.delete=Ka,Y.prototype.get=Za,Y.prototype.has=ti,Y.prototype.set=ei;var ri=it(W,"Map");const Ct=ri;function ni(){this.size=0,this.__data__={hash:new st,map:new(Ct||Y),string:new st}}function oi(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}function Dt(t,e){var r=t.__data__;return oi(e)?r[typeof e=="string"?"string":"hash"]:r.map}function ai(t){var e=Dt(this,t).delete(t);return this.size-=e?1:0,e}function ii(t){return Dt(this,t).get(t)}function si(t){return Dt(this,t).has(t)}function ci(t,e){var r=Dt(this,t),n=r.size;return r.set(t,e),this.size+=r.size==n?0:1,this}function q(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}q.prototype.clear=ni,q.prototype.delete=ai,q.prototype.get=ii,q.prototype.has=si,q.prototype.set=ci;var ui="Expected a function";function ce(t,e){if(typeof t!="function"||e!=null&&typeof e!="function")throw new TypeError(ui);var r=function(){var n=arguments,o=e?e.apply(this,n):n[0],a=r.cache;if(a.has(o))return a.get(o);var i=t.apply(this,n);return r.cache=a.set(o,i)||a,i};return r.cache=new(ce.Cache||q),r}ce.Cache=q;var li=500;function fi(t){var e=ce(t,function(n){return r.size===li&&r.clear(),n}),r=e.cache;return e}var pi=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,di=/\\(\\)?/g,hi=fi(function(t){var e=[];return t.charCodeAt(0)===46&&e.push(""),t.replace(pi,function(r,n,o,a){e.push(o?a.replace(di,"$1"):n||r)}),e});const mi=hi;function vi(t){return t==null?"":Xe(t)}function pt(t,e){return T(t)?t:se(t,e)?[t]:mi(vi(t))}var yi=1/0;function dt(t){if(typeof t=="string"||Qt(t))return t;var e=t+"";return e=="0"&&1/t==-yi?"-0":e}function It(t,e){e=pt(e,t);for(var r=0,n=e.length;t!=null&&r<n;)t=t[dt(e[r++])];return r&&r==n?t:void 0}function mr(t,e,r){var n=t==null?void 0:It(t,e);return n===void 0?r:n}function ue(t,e){for(var r=-1,n=e.length,o=t.length;++r<n;)t[o+r]=e[r];return t}var vr=G?G.isConcatSpreadable:void 0;function gi(t){return T(t)||ne(t)||!!(vr&&t&&t[vr])}function yr(t,e,r,n,o){var a=-1,i=t.length;for(r||(r=gi),o||(o=[]);++a<i;){var s=t[a];e>0&&r(s)?e>1?yr(s,e-1,r,n,o):ue(o,s):n||(o[o.length]=s)}return o}function bi(t){var e=t==null?0:t.length;return e?yr(t,1):[]}function ji(t){return To(Fo(t,void 0,bi),t+"")}var _i=hr(Object.getPrototypeOf,Object);const le=_i;var wi="[object Object]",Si=Function.prototype,Oi=Object.prototype,gr=Si.toString,Ci=Oi.hasOwnProperty,Ei=gr.call(Object);function F(t){if(!Q(t)||ot(t)!=wi)return!1;var e=le(t);if(e===null)return!0;var r=Ci.call(e,"constructor")&&e.constructor;return typeof r=="function"&&r instanceof r&&gr.call(r)==Ei}function Ni(t,e,r){var n=-1,o=t.length;e<0&&(e=-e>o?0:o+e),r=r>o?o:r,r<0&&(r+=o),o=e>r?0:r-e>>>0,e>>>=0;for(var a=Array(o);++n<o;)a[n]=t[n+e];return a}function Mi(){this.__data__=new Y,this.size=0}function $i(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r}function Ai(t){return this.__data__.get(t)}function xi(t){return this.__data__.has(t)}var Ti=200;function Ri(t,e){var r=this.__data__;if(r instanceof Y){var n=r.__data__;if(!Ct||n.length<Ti-1)return n.push([t,e]),this.size=++r.size,this;r=this.__data__=new q(n)}return r.set(t,e),this.size=r.size,this}function H(t){var e=this.__data__=new Y(t);this.size=e.size}H.prototype.clear=Mi,H.prototype.delete=$i,H.prototype.get=Ai,H.prototype.has=xi,H.prototype.set=Ri;function Pi(t,e){return t&&wt(e,Rt(e),t)}function Di(t,e){return t&&wt(e,ie(e),t)}var br=typeof _=="object"&&_&&!_.nodeType&&_,jr=br&&typeof module=="object"&&module&&!module.nodeType&&module,Ii=jr&&jr.exports===br,_r=Ii?W.Buffer:void 0,wr=_r?_r.allocUnsafe:void 0;function ki(t,e){if(e)return t.slice();var r=t.length,n=wr?wr(r):new t.constructor(r);return t.copy(n),n}function Fi(t,e){for(var r=-1,n=t==null?0:t.length,o=0,a=[];++r<n;){var i=t[r];e(i,r,t)&&(a[o++]=i)}return a}function Sr(){return[]}var Li=Object.prototype,Bi=Li.propertyIsEnumerable,Or=Object.getOwnPropertySymbols,Ui=Or?function(t){return t==null?[]:(t=Object(t),Fi(Or(t),function(e){return Bi.call(t,e)}))}:Sr;const fe=Ui;function Gi(t,e){return wt(t,fe(t),e)}var zi=Object.getOwnPropertySymbols,Vi=zi?function(t){for(var e=[];t;)ue(e,fe(t)),t=le(t);return e}:Sr;const Cr=Vi;function Wi(t,e){return wt(t,Cr(t),e)}function Er(t,e,r){var n=e(t);return T(t)?n:ue(n,r(t))}function pe(t){return Er(t,Rt,fe)}function de(t){return Er(t,ie,Cr)}var Hi=it(W,"DataView");const he=Hi;var Ji=it(W,"Promise");const me=Ji;var Qi=it(W,"Set");const ve=Qi;var Nr="[object Map]",Yi="[object Object]",Mr="[object Promise]",$r="[object Set]",Ar="[object WeakMap]",xr="[object DataView]",qi=at(he),Xi=at(Ct),Ki=at(me),Zi=at(ve),ts=at(Xt),ct=ot;(he&&ct(new he(new ArrayBuffer(1)))!=xr||Ct&&ct(new Ct)!=Nr||me&&ct(me.resolve())!=Mr||ve&&ct(new ve)!=$r||Xt&&ct(new Xt)!=Ar)&&(ct=function(t){var e=ot(t),r=e==Yi?t.constructor:void 0,n=r?at(r):"";if(n)switch(n){case qi:return xr;case Xi:return Nr;case Ki:return Mr;case Zi:return $r;case ts:return Ar}return e});const Et=ct;var es=Object.prototype,rs=es.hasOwnProperty;function ns(t){var e=t.length,r=new t.constructor(e);return e&&typeof t[0]=="string"&&rs.call(t,"index")&&(r.index=t.index,r.input=t.input),r}var os=W.Uint8Array;const kt=os;function ye(t){var e=new t.constructor(t.byteLength);return new kt(e).set(new kt(t)),e}function as(t,e){var r=e?ye(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.byteLength)}var is=/\w*$/;function ss(t){var e=new t.constructor(t.source,is.exec(t));return e.lastIndex=t.lastIndex,e}var Tr=G?G.prototype:void 0,Rr=Tr?Tr.valueOf:void 0;function cs(t){return Rr?Object(Rr.call(t)):{}}function us(t,e){var r=e?ye(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.length)}var ls="[object Boolean]",fs="[object Date]",ps="[object Map]",ds="[object Number]",hs="[object RegExp]",ms="[object Set]",vs="[object String]",ys="[object Symbol]",gs="[object ArrayBuffer]",bs="[object DataView]",js="[object Float32Array]",_s="[object Float64Array]",ws="[object Int8Array]",Ss="[object Int16Array]",Os="[object Int32Array]",Cs="[object Uint8Array]",Es="[object Uint8ClampedArray]",Ns="[object Uint16Array]",Ms="[object Uint32Array]";function $s(t,e,r){var n=t.constructor;switch(e){case gs:return ye(t);case ls:case fs:return new n(+t);case bs:return as(t,r);case js:case _s:case ws:case Ss:case Os:case Cs:case Es:case Ns:case Ms:return us(t,r);case ps:return new n;case ds:case vs:return new n(t);case hs:return ss(t);case ms:return new n;case ys:return cs(t)}}function As(t){return typeof t.constructor=="function"&&!re(t)?_o(le(t)):{}}var xs="[object Map]";function Ts(t){return Q(t)&&Et(t)==xs}var Pr=ft&&ft.isMap,Rs=Pr?oe(Pr):Ts;const Ps=Rs;var Ds="[object Set]";function Is(t){return Q(t)&&Et(t)==Ds}var Dr=ft&&ft.isSet,ks=Dr?oe(Dr):Is;const Fs=ks;var Ls=1,Bs=2,Us=4,Ir="[object Arguments]",Gs="[object Array]",zs="[object Boolean]",Vs="[object Date]",Ws="[object Error]",kr="[object Function]",Hs="[object GeneratorFunction]",Js="[object Map]",Qs="[object Number]",Fr="[object Object]",Ys="[object RegExp]",qs="[object Set]",Xs="[object String]",Ks="[object Symbol]",Zs="[object WeakMap]",tc="[object ArrayBuffer]",ec="[object DataView]",rc="[object Float32Array]",nc="[object Float64Array]",oc="[object Int8Array]",ac="[object Int16Array]",ic="[object Int32Array]",sc="[object Uint8Array]",cc="[object Uint8ClampedArray]",uc="[object Uint16Array]",lc="[object Uint32Array]",C={};C[Ir]=C[Gs]=C[tc]=C[ec]=C[zs]=C[Vs]=C[rc]=C[nc]=C[oc]=C[ac]=C[ic]=C[Js]=C[Qs]=C[Fr]=C[Ys]=C[qs]=C[Xs]=C[Ks]=C[sc]=C[cc]=C[uc]=C[lc]=!0,C[Ws]=C[kr]=C[Zs]=!1;function Nt(t,e,r,n,o,a){var i,s=e&Ls,c=e&Bs,u=e&Us;if(r&&(i=o?r(t,n,o,a):r(t)),i!==void 0)return i;if(!Z(t))return t;var f=T(t);if(f){if(i=ns(t),!s)return So(t,i)}else{var d=Et(t),l=d==kr||d==Hs;if(Tt(t))return ki(t,s);if(d==Fr||d==Ir||l&&!o){if(i=c||l?{}:As(t),!s)return c?Wi(t,Di(i,t)):Gi(t,Pi(i,t))}else{if(!C[d])return o?t:{};i=$s(t,d,s)}}a||(a=new H);var m=a.get(t);if(m)return m;a.set(t,i),Fs(t)?t.forEach(function(j){i.add(Nt(j,e,r,j,t,a))}):Ps(t)&&t.forEach(function(j,w){i.set(w,Nt(j,e,r,w,t,a))});var v=u?c?de:pe:c?ie:Rt,y=f?void 0:v(t);return Ro(y||t,function(j,w){y&&(w=j,j=t[w]),te(i,w,Nt(j,e,r,w,t,a))}),i}var fc=1,pc=4;function dc(t){return Nt(t,fc|pc)}var hc="__lodash_hash_undefined__";function mc(t){return this.__data__.set(t,hc),this}function vc(t){return this.__data__.has(t)}function Ft(t){var e=-1,r=t==null?0:t.length;for(this.__data__=new q;++e<r;)this.add(t[e])}Ft.prototype.add=Ft.prototype.push=mc,Ft.prototype.has=vc;function yc(t,e){for(var r=-1,n=t==null?0:t.length;++r<n;)if(e(t[r],r,t))return!0;return!1}function gc(t,e){return t.has(e)}var bc=1,jc=2;function Lr(t,e,r,n,o,a){var i=r&bc,s=t.length,c=e.length;if(s!=c&&!(i&&c>s))return!1;var u=a.get(t),f=a.get(e);if(u&&f)return u==e&&f==t;var d=-1,l=!0,m=r&jc?new Ft:void 0;for(a.set(t,e),a.set(e,t);++d<s;){var v=t[d],y=e[d];if(n)var j=i?n(y,v,d,e,t,a):n(v,y,d,t,e,a);if(j!==void 0){if(j)continue;l=!1;break}if(m){if(!yc(e,function(w,O){if(!gc(m,O)&&(v===w||o(v,w,r,n,a)))return m.push(O)})){l=!1;break}}else if(!(v===y||o(v,y,r,n,a))){l=!1;break}}return a.delete(t),a.delete(e),l}function _c(t){var e=-1,r=Array(t.size);return t.forEach(function(n,o){r[++e]=[o,n]}),r}function wc(t){var e=-1,r=Array(t.size);return t.forEach(function(n){r[++e]=n}),r}var Sc=1,Oc=2,Cc="[object Boolean]",Ec="[object Date]",Nc="[object Error]",Mc="[object Map]",$c="[object Number]",Ac="[object RegExp]",xc="[object Set]",Tc="[object String]",Rc="[object Symbol]",Pc="[object ArrayBuffer]",Dc="[object DataView]",Br=G?G.prototype:void 0,ge=Br?Br.valueOf:void 0;function Ic(t,e,r,n,o,a,i){switch(r){case Dc:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case Pc:return!(t.byteLength!=e.byteLength||!a(new kt(t),new kt(e)));case Cc:case Ec:case $c:return Zt(+t,+e);case Nc:return t.name==e.name&&t.message==e.message;case Ac:case Tc:return t==e+"";case Mc:var s=_c;case xc:var c=n&Sc;if(s||(s=wc),t.size!=e.size&&!c)return!1;var u=i.get(t);if(u)return u==e;n|=Oc,i.set(t,e);var f=Lr(s(t),s(e),n,o,a,i);return i.delete(t),f;case Rc:if(ge)return ge.call(t)==ge.call(e)}return!1}var kc=1,Fc=Object.prototype,Lc=Fc.hasOwnProperty;function Bc(t,e,r,n,o,a){var i=r&kc,s=pe(t),c=s.length,u=pe(e),f=u.length;if(c!=f&&!i)return!1;for(var d=c;d--;){var l=s[d];if(!(i?l in e:Lc.call(e,l)))return!1}var m=a.get(t),v=a.get(e);if(m&&v)return m==e&&v==t;var y=!0;a.set(t,e),a.set(e,t);for(var j=i;++d<c;){l=s[d];var w=t[l],O=e[l];if(n)var x=i?n(O,w,l,e,t,a):n(w,O,l,t,e,a);if(!(x===void 0?w===O||o(w,O,r,n,a):x)){y=!1;break}j||(j=l=="constructor")}if(y&&!j){var $=t.constructor,D=e.constructor;$!=D&&"constructor"in t&&"constructor"in e&&!(typeof $=="function"&&$ instanceof $&&typeof D=="function"&&D instanceof D)&&(y=!1)}return a.delete(t),a.delete(e),y}var Uc=1,Ur="[object Arguments]",Gr="[object Array]",Lt="[object Object]",Gc=Object.prototype,zr=Gc.hasOwnProperty;function zc(t,e,r,n,o,a){var i=T(t),s=T(e),c=i?Gr:Et(t),u=s?Gr:Et(e);c=c==Ur?Lt:c,u=u==Ur?Lt:u;var f=c==Lt,d=u==Lt,l=c==u;if(l&&Tt(t)){if(!Tt(e))return!1;i=!0,f=!1}if(l&&!f)return a||(a=new H),i||pr(t)?Lr(t,e,r,n,o,a):Ic(t,e,c,r,n,o,a);if(!(r&Uc)){var m=f&&zr.call(t,"__wrapped__"),v=d&&zr.call(e,"__wrapped__");if(m||v){var y=m?t.value():t,j=v?e.value():e;return a||(a=new H),o(y,j,r,n,a)}}return l?(a||(a=new H),Bc(t,e,r,n,o,a)):!1}function be(t,e,r,n,o){return t===e?!0:t==null||e==null||!Q(t)&&!Q(e)?t!==t&&e!==e:zc(t,e,r,n,be,o)}var Vc=1,Wc=2;function Hc(t,e,r,n){var o=r.length,a=o,i=!n;if(t==null)return!a;for(t=Object(t);o--;){var s=r[o];if(i&&s[2]?s[1]!==t[s[0]]:!(s[0]in t))return!1}for(;++o<a;){s=r[o];var c=s[0],u=t[c],f=s[1];if(i&&s[2]){if(u===void 0&&!(c in t))return!1}else{var d=new H;if(n)var l=n(u,f,c,t,e,d);if(!(l===void 0?be(f,u,Vc|Wc,n,d):l))return!1}}return!0}function Vr(t){return t===t&&!Z(t)}function Jc(t){for(var e=Rt(t),r=e.length;r--;){var n=e[r],o=t[n];e[r]=[n,o,Vr(o)]}return e}function Wr(t,e){return function(r){return r==null?!1:r[t]===e&&(e!==void 0||t in Object(r))}}function Qc(t){var e=Jc(t);return e.length==1&&e[0][2]?Wr(e[0][0],e[0][1]):function(r){return r===t||Hc(r,t,e)}}function Yc(t,e){return t!=null&&e in Object(t)}function qc(t,e,r){e=pt(e,t);for(var n=-1,o=e.length,a=!1;++n<o;){var i=dt(e[n]);if(!(a=t!=null&&r(t,i)))break;t=t[i]}return a||++n!=o?a:(o=t==null?0:t.length,!!o&&ee(o)&&Kt(i,o)&&(T(t)||ne(t)))}function Xc(t,e){return t!=null&&qc(t,e,Yc)}var Kc=1,Zc=2;function tu(t,e){return se(t)&&Vr(e)?Wr(dt(t),e):function(r){var n=mr(r,t);return n===void 0&&n===e?Xc(r,t):be(e,n,Kc|Zc)}}function eu(t){return function(e){return e==null?void 0:e[t]}}function ru(t){return function(e){return It(e,t)}}function nu(t){return se(t)?eu(dt(t)):ru(t)}function Hr(t){return typeof t=="function"?t:t==null?Ke:typeof t=="object"?T(t)?tu(t[0],t[1]):Qc(t):nu(t)}function ou(t){var e=t==null?0:t.length;return e?t[e-1]:void 0}function au(t,e){return e.length<2?t:It(t,Ni(e,0,-1))}var iu="Expected a function";function su(t){if(typeof t!="function")throw new TypeError(iu);return function(){var e=arguments;switch(e.length){case 0:return!t.call(this);case 1:return!t.call(this,e[0]);case 2:return!t.call(this,e[0],e[1]);case 3:return!t.call(this,e[0],e[1],e[2])}return!t.apply(this,e)}}function cu(t,e){return e=pt(e,t),t=au(t,e),t==null||delete t[dt(ou(e))]}function uu(t){return F(t)?void 0:t}var lu=1,fu=2,pu=4,du=ji(function(t,e){var r={};if(t==null)return r;var n=!1;e=Yt(e,function(a){return a=pt(a,t),n||(n=a.length>1),a}),wt(t,de(t),r),n&&(r=Nt(r,lu|fu|pu,uu));for(var o=e.length;o--;)cu(r,e[o]);return r});const Jr=du;function hu(t,e,r,n){if(!Z(t))return t;e=pt(e,t);for(var o=-1,a=e.length,i=a-1,s=t;s!=null&&++o<a;){var c=dt(e[o]),u=r;if(c==="__proto__"||c==="constructor"||c==="prototype")return t;if(o!=i){var f=s[c];u=n?n(f,c,s):void 0,u===void 0&&(u=Z(f)?f:Kt(e[o+1])?[]:{})}te(s,c,u),s=s[c]}return t}function mu(t,e,r){for(var n=-1,o=e.length,a={};++n<o;){var i=e[n],s=It(t,i);r(s,i)&&hu(a,pt(i,t),s)}return a}function vu(t,e){if(t==null)return{};var r=Yt(de(t),function(n){return[n]});return e=Hr(e),mu(t,r,function(n,o){return e(n,o[0])})}function yu(t,e){return vu(t,su(Hr(e)))}class Qr extends TypeError{constructor(e,r){let n;const{message:o,...a}=e,{path:i}=e,s=i.length===0?o:`At path: ${i.join(".")} -- ${o}`;super(s),this.value=void 0,this.key=void 0,this.type=void 0,this.refinement=void 0,this.path=void 0,this.branch=void 0,this.failures=void 0,Object.assign(this,a),this.name=this.constructor.name,this.failures=()=>n!=null?n:n=[e,...r()]}}function gu(t){return z(t)&&typeof t[Symbol.iterator]=="function"}function z(t){return typeof t=="object"&&t!=null}function L(t){return typeof t=="symbol"?t.toString():typeof t=="string"?JSON.stringify(t):`${t}`}function bu(t){const{done:e,value:r}=t.next();return e?void 0:r}function ju(t,e,r,n){if(t===!0)return;t===!1?t={}:typeof t=="string"&&(t={message:t});const{path:o,branch:a}=e,{type:i}=r,{refinement:s,message:c=`Expected a value of type \`${i}\`${s?` with refinement \`${s}\``:""}, but received: \`${L(n)}\``}=t;return{value:n,type:i,refinement:s,key:o[o.length-1],path:o,branch:a,...t,message:c}}function*Yr(t,e,r,n){gu(t)||(t=[t]);for(const o of t){const a=ju(o,e,r,n);a&&(yield a)}}function*je(t,e,r){r===void 0&&(r={});const{path:n=[],branch:o=[t],coerce:a=!1,mask:i=!1}=r,s={path:n,branch:o};if(a&&(t=e.coercer(t,s),i&&e.type!=="type"&&z(e.schema)&&z(t)&&!Array.isArray(t)))for(const u in t)e.schema[u]===void 0&&delete t[u];let c="valid";for(const u of e.validator(t,s))c="not_valid",yield[u,void 0];for(let[u,f,d]of e.entries(t,s)){const l=je(f,d,{path:u===void 0?n:[...n,u],branch:u===void 0?o:[...o,f],coerce:a,mask:i});for(const m of l)m[0]?(c=m[0].refinement!=null?"not_refined":"not_valid",yield[m[0],void 0]):a&&(f=m[1],u===void 0?t=f:t instanceof Map?t.set(u,f):t instanceof Set?t.add(f):z(t)&&(f!==void 0||u in t)&&(t[u]=f))}if(c!=="not_valid")for(const u of e.refiner(t,s))c="not_refined",yield[u,void 0];c==="valid"&&(yield[void 0,t])}class J{constructor(e){this.TYPE=void 0,this.type=void 0,this.schema=void 0,this.coercer=void 0,this.validator=void 0,this.refiner=void 0,this.entries=void 0;const{type:r,schema:n,validator:o,refiner:a,coercer:i=c=>c,entries:s=function*(){}}=e;this.type=r,this.schema=n,this.entries=s,this.coercer=i,o?this.validator=(c,u)=>{const f=o(c,u);return Yr(f,u,this,c)}:this.validator=()=>[],a?this.refiner=(c,u)=>{const f=a(c,u);return Yr(f,u,this,c)}:this.refiner=()=>[]}assert(e){return qr(e,this)}create(e){return _u(e,this)}is(e){return Su(e,this)}mask(e){return wu(e,this)}validate(e,r){return r===void 0&&(r={}),ht(e,this,r)}}function qr(t,e){const r=ht(t,e);if(r[0])throw r[0]}function _u(t,e){const r=ht(t,e,{coerce:!0});if(r[0])throw r[0];return r[1]}function wu(t,e){const r=ht(t,e,{coerce:!0,mask:!0});if(r[0])throw r[0];return r[1]}function Su(t,e){return!ht(t,e)[0]}function ht(t,e,r){r===void 0&&(r={});const n=je(t,e,r),o=bu(n);return o[0]?[new Qr(o[0],function*(){for(const a of n)a[0]&&(yield a[0])}),void 0]:[void 0,o[1]]}function _e(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];const n=e[0].type==="type",o=e.map(i=>i.schema),a=Object.assign({},...o);return n?tn(a):S(a)}function tt(t,e){return new J({type:t,schema:null,validator:e})}function mt(t){return new J({type:"dynamic",schema:null,*entries(e,r){yield*t(e,r).entries(e,r)},validator(e,r){return t(e,r).validator(e,r)},coercer(e,r){return t(e,r).coercer(e,r)},refiner(e,r){return t(e,r).refiner(e,r)}})}function Xr(t,e){const{schema:r}=t,n={...r};for(const o of e)delete n[o];switch(t.type){case"type":return tn(n);default:return S(n)}}function B(){return tt("any",()=>!0)}function I(t){return new J({type:"array",schema:t,*entries(e){if(t&&Array.isArray(e))for(const[r,n]of e.entries())yield[r,n,t]},coercer(e){return Array.isArray(e)?e.slice():e},validator(e){return Array.isArray(e)||`Expected an array value, but received: ${L(e)}`}})}function X(){return tt("boolean",t=>typeof t=="boolean")}function we(t){const e={},r=t.map(n=>L(n)).join();for(const n of t)e[n]=n;return new J({type:"enums",schema:e,validator(n){return t.includes(n)||`Expected one of \`${r}\`, but received: ${L(n)}`}})}function Kr(){return tt("func",t=>typeof t=="function"||`Expected a function, but received: ${L(t)}`)}function k(t){const e=L(t),r=typeof t;return new J({type:"literal",schema:r==="string"||r==="number"||r==="boolean"?t:null,validator(n){return n===t||`Expected the literal \`${e}\`, but received: ${L(n)}`}})}function Ou(){return tt("never",()=>!1)}function Zr(){return tt("number",t=>typeof t=="number"&&!isNaN(t)||`Expected a number, but received: ${L(t)}`)}function S(t){const e=t?Object.keys(t):[],r=Ou();return new J({type:"object",schema:t||null,*entries(n){if(t&&z(n)){const o=new Set(Object.keys(n));for(const a of e)o.delete(a),yield[a,n[a],t[a]];for(const a of o)yield[a,n[a],r]}},validator(n){return z(n)||`Expected an object, but received: ${L(n)}`},coercer(n){return z(n)?{...n}:n}})}function h(t){return new J({...t,validator:(e,r)=>e===void 0||t.validator(e,r),refiner:(e,r)=>e===void 0||t.refiner(e,r)})}function Mt(t,e){return new J({type:"record",schema:null,*entries(r){if(z(r))for(const n in r){const o=r[n];yield[n,n,t],yield[n,o,e]}},validator(r){return z(r)||`Expected an object, but received: ${L(r)}`}})}function p(){return tt("string",t=>typeof t=="string"||`Expected a string, but received: ${L(t)}`)}function tn(t){const e=Object.keys(t);return new J({type:"type",schema:t,*entries(r){if(z(r))for(const n of e)yield[n,r[n],t[n]]},validator(r){return z(r)||`Expected an object, but received: ${L(r)}`}})}function P(t){const e=t.map(r=>r.type).join(" | ");return new J({type:"union",schema:null,coercer(r,n){return(t.find(o=>{const[a]=o.validate(r,{coerce:!0});return!a})||Cu()).coercer(r,n)},validator(r,n){const o=[];for(const a of t){const[...i]=je(r,a,n),[s]=i;if(s[0])for(const[c]of i)c&&o.push(c);else return[]}return[`Expected the value to satisfy a union of \`${e}\`, but received: ${L(r)}`,...o]}})}function Cu(){return tt("unknown",()=>!0)}const Se=S({package:p(),version:p(),exportName:p(),destructuring:h(X()),subName:h(p()),main:h(p())}),Eu=P([S({globName:p(),type:k(["CDN"]),content:P([Se])}),S({globName:p(),type:k(["FUNCTION"]),content:P([p()])})]);var V=(t=>(t.SLOT="SLOT",t.FUNCTION="FUNCTION",t.EXPRESSION="EXPRESSION",t))(V||{}),Oe=(t=>(t.DESIGN="design",t.SAVE="save",t))(Oe||{}),Ce=(t=>(t.FUNC="FUNC",t.COMP="COMP",t))(Ce||{});const Nu=()=>tt("normalObj",t=>!F(t)||[V.SLOT,V.EXPRESSION,V.FUNCTION].includes(t==null?void 0:t.type)?!1:(ht(t,Mt(p(),Ee)),!0)),Ee=P([p(),Zr(),X(),S({type:k(V.SLOT),renderType:we([Ce.FUNC,Ce.COMP]),params:h(I(p())),value:mt(()=>P([vt,I(vt)]))}),S({type:k(V.EXPRESSION),value:p()}),S({type:k(V.FUNCTION),value:p()}),Nu(),I(mt(()=>Ee))]),en=S({type:k(V.EXPRESSION),value:p()}),vt=S({id:h(p()),title:h(p()),componentName:p(),props:h(Mt(p(),Ee)),stateName:h(p()),state:h(Mt(p(),B())),children:mt(()=>h(I(P([p(),vt])))),configure:h(B()),style:h(p()),className:h(p()),refId:h(p()),extra:h(Mt(B(),B())),condition:h(P([X(),en])),tempDevConfig:h(B()),loop:h(S({open:X(),data:P([I(B()),en]),args:h(I(p())),forName:h(p()),forIndex:h(p()),key:h(B()),name:h(p())}))}),Bt=P([p(),S({label:p(),tip:h(p())})]),Mu=S({type:k("shape"),value:I(S({name:p(),title:Bt,valueType:mt(()=>Ut)}))}),$u=S({type:k("enums"),value:I(p())});S({type:k("array"),value:mt(()=>Ut)});const Au=S({type:k("array"),value:mt(()=>I(Ut))}),Ut=P([we(["array","boolean","number","object","string"]),we(["component","expression","function"]),Mu,$u,Au]),xu=P([p(),S({componentName:p(),props:h(B()),initialValue:h(B())})]),Ne=S({name:p(),title:Bt,valueType:Ut,description:h(p()),defaultValue:B(),setters:h(I(xu)),condition:h(Kr())}),Tu=P([p(),Kr()]);var Me=(t=>(t.SINGLE="single",t.GROUP="group",t))(Me||{});P([p(),S({name:p(),describe:h(p()),params:h(S({name:p(),description:p()})),template:p()})]);const Ru=S({id:h(p()),title:p(),snapshot:P([p(),B()]),snapshotText:h(p()),description:h(p()),tags:h(I(p())),groupName:h(p()),category:h(p()),schema:_e(Xr(vt,["id"]),S({componentName:h(p())}))}),Pu=S({componentName:p(),title:p(),screenshot:h(p()),icon:h(p()),tags:h(I(p())),groupName:h(p()),category:h(p()),priority:h(Zr()),npm:P([Se,k(!1)]),snippets:I(Ru),props:I(P([Ne,S({title:h(Bt),type:k("single"),content:Ne}),S({title:h(Bt),type:k("group"),content:I(Ne)})])),isContainer:h(P([X(),S({placeholder:p(),width:p(),height:p()})])),isModal:h(P([X(),S({visibleKey:p()})])),isSupportStyle:h(X()),isSupportDispatchNativeEvent:h(X()),isLayout:h(X()),rootSelector:h(p()),selectionToolBars:h(I(Tu)),extra:h(Mt(B(),B()))}),Du=t=>({data:e,message:r,throwError:n})=>{const o=t({data:e,message:r,throwError:n});if(o.isValidate)return o;if(n)throw o.message||r?new Error(`${o.message||r}
 originData: ${JSON.stringify(e)}`):new Error(`${JSON.stringify(e)} 
 data struct format is invalidate`);return o},$e=t=>{const{data:e,message:r,throwError:n,dataStruct:o}=t;return Du(({data:a})=>{try{return qr(a,o),{isValidate:!0}}catch(i){let s=i;return i instanceof Qr&&(s=i.failures().map(c=>`\u3010${c.path.join(".")}\u3011: ${c.message}
`)),{isValidate:!1,message:s,error:i}}})({data:e,message:r,throwError:n})};var Ae=(t=>(t.PAGE="CPage",t))(Ae||{});const Iu=_e(Xr(vt,["componentName"]),S({componentName:k("CPage")}));function ku(t){return{all:t=t||new Map,on:function(e,r){var n=t.get(e);n?n.push(r):t.set(e,[r])},off:function(e,r){var n=t.get(e);n&&(r?n.splice(n.indexOf(r)>>>0,1):t.set(e,[]))},emit:function(e,r){var n=t.get(e);n&&n.slice().map(function(o){o(r)}),(n=t.get("*"))&&n.slice().map(function(o){o(e,r)})}}}const $t=ku(),Fu=(t,e)=>{const r={...t,value:[]},n=t.value;let o=new ut([]);return e&&(o=e.materialsMode||new ut([])),n&&(T(n)?r.value=n.map(a=>new M(a,{parent:e,materials:o})):F(n)&&r.value.push(new M(n,{parent:e,materials:o}))),r};class yt{constructor(e,r){g(this,"nodeType","SLOT"),g(this,"rawData"),g(this,"parent"),g(this,"emitter",$t),g(this,"data"),g(this,"id"),g(this,"materialsMode"),this.parent=(r==null?void 0:r.parent)||null,this.rawData=e;const n=(r==null?void 0:r.materials)||new ut([]);this.materialsMode=n,this.id=K(),this.data=Fu(e,this)}get value(){return this.data}export(e){const r=this.data,n=o=>{if(o instanceof M)return o.export(e);if(F(o)){const a={};return Object.keys(o||{}).forEach(i=>{a[i]=n(o[i])}),a}return T(o)?o.map(a=>n(a)):o};return n(r)}}const rn=t=>{let e=[];return t.forEach(r=>{const n=r;n.type?n.type===Me.SINGLE?e.push(n.content):n.type===Me.GROUP&&(e=[...e,...rn(n.content)]):e.push(r)}),e},xe=(t,e,r)=>{if(t.type)return t.type===V.SLOT?new yt(t,{parent:e,materials:r}):t;if(F(t)){const n={};return Object.keys(t).forEach(o=>{n[o]=Te(t[o],e,r)}),n}else return Array.isArray(t)?t.map(n=>xe(n,e,r)):t},Te=(t,e,r)=>F(t)?xe(t,e,r):T(t)?t.map(n=>xe(n,e,r)):t;class et{constructor(e,r,n){g(this,"nodeType","PROP"),g(this,"rawData"),g(this,"parent"),g(this,"emitter",$t),g(this,"data"),g(this,"name"),g(this,"materialsMode");const o=(n==null?void 0:n.materials)||new ut([]);this.materialsMode=o,this.parent=n==null?void 0:n.parent,this.rawData=r,this.name=e,this.data=Te(r,this,o)}isIncludeSlot(){return!1}isIncludeExpression(){return!1}get value(){return this.data}updateValue(e){const r=this.data;this.data=Te(e!=null?e:r,this,this.materialsMode),this.emitter.emit("onPropChange",{value:this.data,preValue:r,node:this}),this.parent&&!(this.parent instanceof yt)&&this.emitter.emit("onNodeChange",{value:this.parent.value,preValue:this.parent.value,node:this.parent})}get material(){const e=this.parent;if(e instanceof M){const r=e.material;return rn((r==null?void 0:r.value.props)||[]).find(n=>n.name===this.name)}else return null}export(e){const r=this.data,n=o=>{if(o instanceof et||o instanceof yt||o instanceof M)return o.export(e);if(T(o))return o.map(a=>n(a));if(F(o)){const a={};return Object.keys(o||{}).forEach(i=>{a[i]=n(o[i])}),a}return o};return n(r)}}const Lu=t=>{if(typeof t=="string")return!0;$e({data:t,dataStruct:vt,throwError:!0})},nn=(t,e,r=new ut([]))=>{var n;if(typeof t=="string")return t;const o={...t,id:(n=t.id)!=null?n:K(),children:[],props:{}},a=Object.keys(t.props||{});return a.length&&a.forEach(i=>{var s;const c=(s=t.props)==null?void 0:s[i];if(c instanceof et){o.props[i]=c;return}o.props[i]=new et(i,c||"",{parent:e,materials:r})}),t.children&&(Array.isArray(t.children)?o.children=t.children.map(i=>{if(i instanceof M)return i;if(F(i)){const s=i;return new M(s,{parent:e,materials:r})}else return i}):(t.children instanceof M&&(o.children=[t.children]),o.children=[new M(t.children,{parent:e,materials:r})])),o};class M{constructor(e,r){g(this,"nodeType","NODE"),g(this,"rawData"),g(this,"data"),g(this,"emitter",$t),g(this,"parent"),g(this,"materialsModel"),g(this,"listenerHandle"),g(this,"onChangeCbQueue"),this.rawData=JSON.parse(JSON.stringify(e)),Lu(e);const n=(r==null?void 0:r.materials)||new ut([]);this.parent=(r==null?void 0:r.parent)||null,this.materialsModel=n,this.data=nn(e,this,n),this.listenerHandle=[],this.onChangeCbQueue=[],this.registerListener()}registerListener(){const e=r=>{const{node:n}=r;n===this&&n.id===this.id&&this.onChangeCbQueue.forEach(o=>o(r))};this.emitter.on("onNodeChange",e),this.listenerHandle.push(()=>{this.emitter.off("onNodeChange",e)})}onChange(e){return this.onChangeCbQueue.push(e),()=>{this.onChangeCbQueue=this.onChangeCbQueue.filter(r=>r!==e)}}destroy(){this.listenerHandle.forEach(e=>e())}get id(){return this.data.id}get value(){return this.data}clone(e){const r={...this.export("design"),id:e||K()};return new M(r)}updateValue(e){const r=this.data,n={...this.data,...e};this.data=nn(n,this),this.emitter.emit("onNodeChange",{value:n,preValue:r,node:this})}contains(e){return Ie(this,e)}get props(){return this.data.props}get material(){const e=this.materialsModel;return e==null?void 0:e.findByComponentName(this.data.componentName)}getPlainProps(){const e=this.data,r={};return Object.keys(e.props||{}).forEach(n=>{r[n]=e.props[n].export("design")}),r}export(e){var r;const n=this.data;if(typeof n=="string")return n;const o={};Object.keys(n.props||{}).forEach(f=>{o[f]=n.props[f].export(e)});const a=(r=n.children)==null?void 0:r.map(f=>f instanceof M?f.export(e):f),i=n.configure||{},s=i.props||{},c={};Object.keys(s).forEach(f=>{const d=mr(s,f,!1);d&&(c[f]=d)}),i.props=c;let u={...n,configure:i,props:o,children:a};return u=De(u),u}}const on=(t,e,r)=>{const n={...t,id:K(),props:{},componentName:Ae.PAGE,children:[]};let o=[];T(t.children)?o=t.children.map(i=>i instanceof M?i:F(i)?new M(i,{parent:e,materials:r}):i):t.children instanceof M?o.push(t.children):t.children&&F(t.children)?o.push(new M(t.children,{parent:e,materials:r})):o.push(t.children,{parent:e});const a=Object.keys(t.props||{});return a.length&&a.forEach(i=>{var s;const c=(s=t.props)==null?void 0:s[i];c instanceof et?n.props[i]=c:n.props[i]=new et(i,c||"",{parent:e,materials:r})}),n.children=o,n};class Re{constructor(e,{parent:r,materials:n}){g(this,"rawData"),g(this,"data"),g(this,"nodeType","SCHEMA"),g(this,"emitter",$t),g(this,"materialsModel"),g(this,"listenerHandle"),g(this,"onChangeCbQueue"),g(this,"parent"),this.materialsModel=n,this.rawData=JSON.parse(JSON.stringify(e)),this.data=on(e,this,n),this.listenerHandle=[],this.onChangeCbQueue=[],this.registerListener(),this.parent=r}registerListener(){const e=r=>{const{node:n}=r;n===this&&n.id===this.id&&this.onChangeCbQueue.forEach(o=>o(r))};this.emitter.on("onNodeChange",e),this.listenerHandle.push(()=>{this.emitter.off("onNodeChange",e)})}onChange(e){return this.onChangeCbQueue.push(e),()=>{this.onChangeCbQueue=this.onChangeCbQueue.filter(r=>r!==e)}}get id(){return this.data.id}get value(){return this.data}get props(){return this.data.props}get material(){const e=this.materialsModel;return e==null?void 0:e.findByComponentName(this.data.componentName)}updateValue(e){const r=this.data,n={...this.data,...e};this.data=on(n,this,this.materialsModel),this.emitter.emit("onNodeChange",{value:this.data,preValue:r,node:this})}contains(e){return Ie(this,e)}export(e=Oe.SAVE){var r;const n=this.data,o={};Object.keys(n.props||{}).forEach(c=>{o[c]=n.props[c].export(e)});const a=(r=n.children)==null?void 0:r.map(c=>c.export(e)),i={...n,props:o,children:a};let s=Jr(i,["id"]);return s=De(s),s}}const Gt=t=>(t==null?void 0:t.type)===V.EXPRESSION,Bu=t=>(t==null?void 0:t.type)==V.FUNCTION,K=()=>Math.random().toString(32).slice(3,9),Uu=t=>(t==null?void 0:t.nodeType)==="NODE",Pe=t=>(t==null?void 0:t.nodeType)==="PROP",Gu=t=>(t==null?void 0:t.nodeType)==="SLOT",De=t=>yu(t,e=>F(e)?!Object.keys(e).length:T(e)?!e.length:!e);function Ie(t,e){const r=[t];for(;r.length;){const n=r.shift();if((n==null?void 0:n.id)===e)return n;const o=(n==null?void 0:n.props)||{},a=s=>{if(s instanceof M){r.push(s);return}if(s instanceof yt&&a(s.value.value),s instanceof et){a(s.value);return}if(F(s)){const c=s;Object.keys(c).map(u=>{a(c[u])});return}if(T(s)){s.forEach(c=>{a(c)});return}};a(o);const i=(n==null?void 0:n.value.children.filter(s=>s instanceof M))||[];r.push(...i)}return null}const zu=t=>{const e=dc(t);return e.snippets=e.snippets.map(r=>({...r,id:r.id||`${t.componentName}-${K()}`,title:r.title||t.title,category:r.category||t.category,tags:[...r.tags||[],...t.tags||[]],groupName:r.groupName||t.groupName,snapshot:r.snapshot||t.icon,snapshotText:r.snapshotText,schema:{...r.schema,componentName:r.schema.componentName||t.componentName}})),e};class Vu{constructor(e){g(this,"rawData"),g(this,"data"),this.rawData=e,this.data=zu(e)}get value(){return this.data}get componentName(){return this.data.componentName}get snippets(){return this.data.snippets}getSnippetById(e){return this.data.snippets.find(r=>r.id===e)}}const Wu=t=>{if(!T(t))throw new Error("Materials must be a array");return t.map(e=>new Vu(e))},Hu=t=>{t==null||t.forEach(e=>{$e({data:e,dataStruct:Pu,throwError:!0})})};class ut{constructor(e){g(this,"rowData"),g(this,"data"),this.rowData=e,Hu(e),this.data=Wu(e)}findByComponentName(e){return this.data.find(r=>r.componentName===e)}findSnippetById(e){const r=[...this.data];let n=null;for(;!n&&r.length;){const o=r.pop();n=o==null?void 0:o.getSnippetById(e)}return n}getAllSnippets(){let e=this.data.reduce((a,i)=>(a.push(...i.snippets),a),[]);const r=["default"],n={default:[]};e=e.sort((a,i)=>(a.category||"")>(i.category||"")?1:-1),e.forEach(a=>{const i=a.groupName||"default";r.includes(i)||(r.push(i),n[i]=[]),n[i].push(a)});const o=[];return r.forEach(a=>{const i=["default"],s={default:[]},c=n[a];if(c.length!==0){c.forEach(d=>{const l=d.category||"default";i.includes(l)||(i.push(l),s[l]=[]),s[l].push(d)});const u=[];i.forEach(d=>{s[d].length&&u.push({name:d,list:s[d]})});const f={name:a,list:u};o.push(f)}}),o}get value(){return this.data}}const Ju=S({version:p(),pageName:p(),style:h(p()),css:h(p()),componentsMeta:I(_e(S({componentName:p()}),Se)),thirdLibs:h(Eu),componentsTree:Iu}),Qu=t=>($e({data:t,dataStruct:Ju,throwError:!0}),t),Yu=(t,e,r)=>({...t,componentsTree:new Re(t.componentsTree,{parent:e,materials:r})});class zt{constructor(e,r){g(this,"nodeType","PAGE"),g(this,"rawData"),g(this,"emitter",$t),g(this,"data"),g(this,"parent"),g(this,"materialsModel"),Qu(e),this.rawData=JSON.parse(JSON.stringify(e)),this.materialsModel=new ut((r==null?void 0:r.materials)||[]),this.data=Yu(e,this,this.materialsModel)}get value(){return this.data}getNode(e){const r=this.data.componentsTree;return Ie(r,e)}addNode(e,r,n="AFTER"){var o,a,i;if(n==="AFTER"||n==="BEFORE"){const s=r.parent;if(s===null&&r instanceof Re)return console.warn("Not found parent node"),!1;if(s instanceof et)return console.warn("CProp can not add node"),!1;if(s instanceof yt){const u=s.value.value,f=(o=u.findIndex(d=>d===r))!=null?o:-1;return f>=0?(n==="BEFORE"?u.splice(f,0,e):u.splice(f+1,0,e),e.parent=s,(a=s.parent)==null||a.updateValue(),!0):!1}if(s instanceof zt)return!1;const c=(i=s==null?void 0:s.value.children.findIndex(u=>u===r))!=null?i:-1;return c>=0?(n==="BEFORE"?s==null||s.value.children.splice(c,0,e):s==null||s.value.children.splice(c+1,0,e),e.parent=s,s==null||s.updateValue(),!0):(console.warn("Not found target node"),!1)}if(n==="CHILD_START")return r.value.children.unshift(e),e.parent=r,r.updateValue(),!0;if(n==="CHILD_END")return r.value.children.push(e),e.parent=r,r.updateValue(),!0;if(F(n)){const s=n;if(s.type==="CHILD"){const c=s.pos,u=s.index||0;return c==="BEFORE"?r==null||r.value.children.splice(u,0,e):r==null||r.value.children.splice(u+1,0,e),e.parent=r,r.updateValue(),!0}else console.warn("Can not parse pos obj")}return!1}createNode(e){return delete e.id,new M(e,{parent:null,materials:this.materialsModel})}addNodeById(e,r,n="AFTER"){const o=this.getNode(r);return o?this.addNode(e,o,n):(console.warn(`Not find a node by ${r}, pls check it`),!1)}copyNode(e){const r=e.export("design");r.id=K();const n=new M(r,{parent:e.parent,materials:this.materialsModel});return this.addNode(n,e,"AFTER"),n}copyNodeById(e){const r=this.getNode(e);return r&&r instanceof M?this.copyNode(r):!1}moveNode(e,r,n){this.deleteNode(e);let o=r;return["AFTER","BEFORE"].includes(n)&&(o=r.parent),e.parent=o,this.addNode(e,r,n)}moveNodeById(e,r,n){const o=this.getNode(e),a=this.getNode(r);return o&&a&&o instanceof M&&a instanceof M?this.moveNode(o,a,n):!1}deleteNode(e){var r;const n=e.parent;if(!n)throw new Error("parent node is null or undefined, pls check it");if(n instanceof yt){const o=n.value.value,a=o.findIndex(s=>s===e),i=o[a];return o.splice(a,1),(r=n.parent)==null||r.updateValue(),i}if(n instanceof M||n instanceof Re){const o=n.value.children,a=o.findIndex(s=>s===e),i=o[a];return o.splice(a,1),n.updateValue(),i}}deleteNodeById(e){const r=this.getNode(e);if(r)return this.deleteNode(r)}export(e=Oe.SAVE){const r=this.data.componentsTree.export(e);let n={...this.data,componentsTree:De(r)};return n=Jr(n,["id"]),JSON.parse(JSON.stringify(n))}}var qu=typeof global=="object"&&global&&global.Object===Object&&global;const Xu=qu;var Ku=typeof self=="object"&&self&&self.Object===Object&&self,Zu=Xu||Ku||Function("return this")(),tl=Zu.Symbol;const gt=tl;var an=Object.prototype,el=an.hasOwnProperty,rl=an.toString,At=gt?gt.toStringTag:void 0;function nl(t){var e=el.call(t,At),r=t[At];try{t[At]=void 0;var n=!0}catch{}var o=rl.call(t);return n&&(e?t[At]=r:delete t[At]),o}var ol=Object.prototype,al=ol.toString;function il(t){return al.call(t)}var sl="[object Null]",cl="[object Undefined]",sn=gt?gt.toStringTag:void 0;function cn(t){return t==null?t===void 0?cl:sl:sn&&sn in Object(t)?nl(t):il(t)}function un(t){return t!=null&&typeof t=="object"}var ul="[object Symbol]";function ll(t){return typeof t=="symbol"||un(t)&&cn(t)==ul}function fl(t,e){for(var r=-1,n=t==null?0:t.length,o=Array(n);++r<n;)o[r]=e(t[r],r,t);return o}var pl=Array.isArray;const ke=pl;var dl=1/0,ln=gt?gt.prototype:void 0,fn=ln?ln.toString:void 0;function pn(t){if(typeof t=="string")return t;if(ke(t))return fl(t,pn)+"";if(ll(t))return fn?fn.call(t):"";var e=t+"";return e=="0"&&1/t==-dl?"-0":e}function hl(t,e){return function(r){return t(e(r))}}function dn(t){return t==null?"":pn(t)}var ml=hl(Object.getPrototypeOf,Object);const vl=ml;var yl="[object Object]",gl=Function.prototype,bl=Object.prototype,hn=gl.toString,jl=bl.hasOwnProperty,_l=hn.call(Object);function Fe(t){if(!un(t)||cn(t)!=yl)return!1;var e=vl(t);if(e===null)return!0;var r=jl.call(e,"constructor")&&e.constructor;return typeof r=="function"&&r instanceof r&&hn.call(r)==_l}function wl(t,e,r){var n=-1,o=t.length;e<0&&(e=-e>o?0:o+e),r=r>o?o:r,r<0&&(r+=o),o=e>r?0:r-e>>>0,e>>>=0;for(var a=Array(o);++n<o;)a[n]=t[n+e];return a}function Sl(t,e,r){var n=t.length;return r=r===void 0?n:r,!e&&r>=n?t:wl(t,e,r)}var Ol="\\ud800-\\udfff",Cl="\\u0300-\\u036f",El="\\ufe20-\\ufe2f",Nl="\\u20d0-\\u20ff",Ml=Cl+El+Nl,$l="\\ufe0e\\ufe0f",Al="\\u200d",xl=RegExp("["+Al+Ol+Ml+$l+"]");function mn(t){return xl.test(t)}function Tl(t){return t.split("")}var vn="\\ud800-\\udfff",Rl="\\u0300-\\u036f",Pl="\\ufe20-\\ufe2f",Dl="\\u20d0-\\u20ff",Il=Rl+Pl+Dl,kl="\\ufe0e\\ufe0f",Fl="["+vn+"]",Le="["+Il+"]",Be="\\ud83c[\\udffb-\\udfff]",Ll="(?:"+Le+"|"+Be+")",yn="[^"+vn+"]",gn="(?:\\ud83c[\\udde6-\\uddff]){2}",bn="[\\ud800-\\udbff][\\udc00-\\udfff]",Bl="\\u200d",jn=Ll+"?",_n="["+kl+"]?",Ul="(?:"+Bl+"(?:"+[yn,gn,bn].join("|")+")"+_n+jn+")*",Gl=_n+jn+Ul,zl="(?:"+[yn+Le+"?",Le,gn,bn,Fl].join("|")+")",Vl=RegExp(Be+"(?="+Be+")|"+zl+Gl,"g");function Wl(t){return t.match(Vl)||[]}function Hl(t){return mn(t)?Wl(t):Tl(t)}function Jl(t){return function(e){e=dn(e);var r=mn(e)?Hl(e):void 0,n=r?r[0]:e.charAt(0),o=r?Sl(r,1).join(""):e.slice(1);return n[t]()+o}}var Ql=Jl("toUpperCase");const Yl=Ql;function Ue(t){return Yl(dn(t).toLowerCase())}function ql(t){const e=t.prototype;return!!(e&&e.isReactComponent)}function Xl(t){var n,o;const r=typeof Symbol=="function"&&Symbol.for?Symbol.for("react.forward_ref"):60112;return(t==null?void 0:t.$$typeof)===r||((n=t==null?void 0:t.prototype)==null?void 0:n.isReactComponent)||((o=t==null?void 0:t.prototype)==null?void 0:o.setState)||t._forwardRef}function Kl(t){class e extends R.Component{render(){return R.createElement(t,this.props)}}return e.displayName=t.displayName,e}const Vt=(t,e)=>{const r=n=>{const a=`
    ${Object.keys(e).map(i=>`const ${i} = $$context['${i}'];`).join(`
`)}
    return ${n};
    `;return new Function("$$context",a)(e)};try{return r(t)}catch(n){console.warn(n);const o=`[${t}] expression run failed`;return console.warn(o),null}},Zl=(t,e,r)=>function(...o){try{const a=`
        var f = ${t};
        var args = Array.from(arguments);
        var __$$storeManager__ = args.pop();
        var $$context = args.pop();
        $$context.stateManager = __$$storeManager__.getStateSnapshot();
        return f.apply(f, args)
      `;new Function(a)(...o,e,r)}catch(a){console.warn(a)}},wn=(t,e)=>{const r={};return e.forEach((n,o)=>{r[n]=t[o]}),r},tf=t=>{const e={};return Object.keys(t).forEach(r=>{let n=r.split("-");n.length>=2&&(n=n.map((o,a)=>a!==0?Ue(o):o)),e[n.join("")]=t[r]}),e},Wt="DYNAMIC",ef=["$$context","$$nodeModel"],Sn=t=>{let e;const r=new Set,n=(c,u)=>{const f=typeof c=="function"?c(e):c;if(!Object.is(f,e)){const d=e;e=(u!=null?u:typeof f!="object")?f:Object.assign({},e,f),r.forEach(l=>l(e,d))}},o=()=>e,s={setState:n,getState:o,subscribe:c=>(r.add(c),()=>r.delete(c)),destroy:()=>r.clear()};return e=t(n,o,s),s},rf=t=>t?Sn(t):Sn;class nf{constructor(){b(this,"storeMap",new Map)}addStore(e,r){const n=rf(r);return this.storeMap.set(e,n),n.name=e,n}setStore(e,r){this.storeMap.set(e,r)}removeStore(e){this.storeMap.delete(e)}getStore(e){return this.storeMap.get(e)}connect(e,r){const n=this.storeMap.get(e);n?n.subscribe(r):console.warn("store not exits")}getStateSnapshot(){const e={};return this.storeMap.forEach((r,n)=>{e[n]={state:r.getState(),updateState:o=>{r.setState(o)}}}),e}destroy(){this.storeMap.forEach(e=>{e.destroy()}),this.storeMap=new Map}}class of{constructor(){b(this,"renderMode","normal");b(this,"components",{});b(this,"storeManager",new nf);b(this,"runtimeComponentCache",new Map);b(this,"onGetRef");b(this,"onGetComponent");b(this,"onComponentMount");b(this,"onComponentDestroy")}getComponent(e){var o;const r=e.value.componentName;let n=this.components[r]||(()=>"Component not found");return Xl(n)||(n=Kl(n),this.components[r]=n),this.onGetComponent&&(n=(o=this.onGetComponent)==null?void 0:o.call(this,n,e)),n}getContext(e={},r){let n=e;return r&&(n={...e},n.__proto__=r||null),n}pageRender(e,{components:r,onGetRef:n,$$context:o={},onGetComponent:a,onComponentMount:i,onComponentDestroy:s,renderMode:c}){this.renderMode=c,this.components=r,this.onGetRef=n,this.onGetComponent=a,this.onComponentMount=i,this.onComponentDestroy=s;const u=e.value.componentsTree,f=this.getComponent(u),d=this.convertModelToComponent(f,e.value.componentsTree),l={},m=u.props;return Object.keys(m).forEach(v=>{l[v]=m[v].value}),l.$$context=o,this.render(d,l)}transformProps(e={},{$$context:r}){const n=e,o=i=>{if(Array.isArray(i))return i.map(s=>o(s));if(Pe(i))return o(i.value);if(Gu(i)){const s=i.value,c=s.value;if(!c)return console.warn("slot value is null, this maybe cause some error, pls check it",e),()=>{};const u=f=>{const d=`${f.id}-${Wt}`;if(this.runtimeComponentCache.get(f.id))return{key:d,component:this.runtimeComponentCache.get(f.id)};const l=this.getComponent(f),m=this.convertModelToComponent(l,f),v=s.params||[];return{component:(...w)=>{const O=wn(w,v),x=this.getContext({params:O},r);return this.render(m,{$$context:x,key:d})},key:d}};if(Array.isArray(c)){const f=c==null?void 0:c.map(d=>u(d));return(...d)=>f.map(l=>ql(l.component)?A.default.createElement(l.component,{$$context:r,key:l.key}):l.component(...d))}else return u(c).component}else{if(Gt(i))return Vt(i.value,r||{});if(Bu(i))return Zl(i.value,r,this.storeManager);if(Fe(i)){let s=i;Pe(i)&&(s=i.value);const c=s,u={};return Object.keys(s).forEach(f=>{u[f]=o(c[f])}),u}else return i}},a={};return Object.keys(n).forEach(i=>{const s=n[i];a[i]=o(s)}),a}collectSpecialProps(e={},r){const n=[],o=(a,i)=>{let s=i;Pe(i)&&(s=i.value),r(s)?n.push({keyPath:a,val:s}):ke(s)?s.forEach((c,u)=>{o([...a,String(u)],c)}):Fe(s)&&Object.keys(s).forEach(c=>{o([...a,c],s[c])})};return o(["$root"],e),n}convertModelToComponent(e,r){const n=this;class o extends A.default.Component{constructor(s){super(s);b(this,"_CONDITION",!0);b(this,"_DESIGN_BOX",!1);b(this,"_NODE_MODEL",r);b(this,"_NODE_ID",r.id);b(this,"UNIQUE_ID",`${r.id}_${K()}`);b(this,"targetComponentRef");b(this,"listenerHandle",[]);b(this,"storeState");b(this,"updateState",s=>{this.storeState.setState(s),this.forceUpdate()});this.targetComponentRef=A.default.createRef(),this.state=r.value.state||{};const c=r.value.stateName||r.id,u=n.storeManager.getStore(c);u?(this.storeState=u,u.setState({...r.value.state||{}})):this.storeState=n.storeManager.addStore(c,()=>({...r.value.state||{}})),this.storeState.subscribe(f=>{this.setState({...f})}),this.connectStore()}connectStore(){const c=n.collectSpecialProps(r.props,u=>!!Gt(u)).map(u=>{const f=u.val,l=/\$\$context.stateManager\.(.+?)\./gim.exec(f.value);return l!=null&&l.length?l[1]:""}).filter(Boolean);c.length&&c.forEach(u=>{n.storeManager.getStore(u)||n.storeManager.addStore(u,()=>({})),n.storeManager.connect(u,()=>{this.forceUpdate()})})}componentDidMount(){var c;n.onGetRef&&n.onGetRef(this.targetComponentRef,r,this),(c=n.onComponentMount)==null||c.call(n,this,r);const s=()=>{n.storeManager.setStore(r.value.stateName||r.id,this.storeState),this.storeState.setState({...this.state,...r.value.state||{}}),this.forceUpdate()};r.onChange(s)}componentWillUnmount(){var s;(s=n.onComponentDestroy)==null||s.call(n,this,r)}render(){var x;const{$$context:s,...c}=this.props,u={key:r.id,...r.props,...c},f={state:this.state||{},updateState:this.updateState};r.value.componentName===Ae.PAGE&&(f.globalState=this.state,f.updateGlobalState=this.updateState),f.stateManager=n.storeManager.getStateSnapshot();const d=n.getContext(f,s),l=r.value.loop;let m=[];if(l&&l.open){this.targetComponentRef.current=[];let $=l.data||[];if(Gt(l.data)){const D=l.data;$=Vt(D.value,d||{})}return m=$.map((...D)=>{const U=D[1],N=[l.forName||"item",l.forIndex||"index"],bt=wn(D,N);let rt="loopData";l.name&&(rt=`${rt}${l.name}`);const Ht=n.getContext({[rt]:bt},d),lt=n.transformProps(u,{$$context:Ht}),{children:Jt}=lt;let ze=[];if(Jt!==void 0)delete lt.children,ze=Array.isArray(Jt)?Jt:[Jt];else{const jt=[];r.value.children.forEach((vf,yf)=>{const gf=n.buildComponent(vf,{$$context:d,idx:yf});jt.push(gf)}),ze=jt}if(lt.key=`${lt.key}-${U}`,Gt(l.key)){const jt=l.key,Tn=Vt(jt.value,Ht||{});lt.key+=`-${Tn}`}return lt.ref=jt=>{this.targetComponentRef.current=this.targetComponentRef.current||[],this.targetComponentRef.current[U]=jt},n.render(e,lt,...ze)}),m}const v=n.transformProps(u,{$$context:d}),{children:y}=v;let j=[];if(y!==void 0)delete v.children,j=Array.isArray(y)?y:[y];else{const $=[];r.value.children.forEach((U,N)=>{const bt=n.buildComponent(U,{$$context:d,idx:N});$.push(bt)}),j=$}v.ref=this.targetComponentRef,v.style&&(v.style=tf(v.style));const w=n.render(e,v,...j);let O=(x=r.value.condition)!=null?x:!0;return typeof O!="boolean"&&(O=Vt(O.value,d||{})),this._CONDITION=O,O?w:A.default.createElement("div",{style:{display:"none"}},w)}}return b(o,"__CP_TYPE__",Wt),o.displayName=`${r.value.componentName}Dynamic`,o}buildComponent(e,{$$context:r={}}){const n=this.runtimeComponentCache;return typeof e=="string"?this.render(e):Uu(e)?(({currentNode:a})=>{const i=a.value.id;let s=null;if(n.get(i))s=n.get(i);else{const f=this.getComponent(a);s=this.convertModelToComponent(f,a)}!n.get(i)&&this.renderMode!=="design"&&n.set(i,s);const c=`${i}-${Wt}`,u={$$context:r,$$nodeModel:e,key:c};return this.render(s,u)})({currentNode:e}):void 0}render(e,r={},...n){return typeof e=="string"||typeof e=="number"?String(e):(ef.forEach(a=>{a in r&&e.__CP_TYPE__!==Wt&&delete r[a]}),A.default.createElement(e,r,...n))}clear(){this.runtimeComponentCache.clear(),this.storeManager.destroy()}}const af=We(new of),On=["a","abbr","acronym","address","applet","area","article","aside","audio","b","base","basefont","bdi","bdo","bgsound","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","command","content","data","datalist","dd","del","details","dfn","dialog","dir","div","dl","dt","element","em","embed","fieldset","figcaption","figure","font","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","image","img","input","ins","isindex","kbd","keygen","label","legend","li","link","listing","main","map","mark","marquee","math","menu","menuitem","meta","meter","multicol","nav","nextid","nobr","noembed","noframes","noscript","object","ol","optgroup","option","output","p","param","picture","plaintext","pre","progress","q","rb","rbc","rp","rt","rtc","ruby","s","samp","script","section","select","shadow","slot","small","source","spacer","span","strike","strong","style","sub","summary","sup","svg","table","tbody","td","template","textarea","tfoot","th","thead","time","title","tr","track","tt","u","ul","var","video","wbr","xmp"],sf=On.reduce((t,e)=>(t[e]=({children:r,...n})=>{let o=r;return Array.isArray(r)||(o=[r]),A.default.createElement(e,n,...o)},t),{});On.map(t=>({title:Ue(t),componentName:t,npm:!1,icon:"",props:[{name:"style",title:"\u6837\u5F0F",valueType:"object",setters:["JSONSetter"]},{name:"className",title:"\u7C7B\u540D",valueType:"string",setters:["StringSetter"]}],snippets:[{title:`${Ue(t)}`,snapshotText:t,category:"HTML \u5143\u7D20",schema:{props:{},children:[`I am a ${t}`]}}]}));const cf={CPage:({children:t})=>t,...sf};class uf{constructor(){b(this,"refMap",new Map)}get(e){return this.refMap.get(e)}add(e,r){this.refMap.set(e,r)}remove(e){this.refMap.delete(e)}destroy(){this.refMap.clear()}}class Cn extends A.default.Component{constructor(r){super(r);b(this,"refManager");b(this,"dynamicComponentInstanceMap",new Map);b(this,"onGetRef",(r,n,o)=>{var a,i;(i=(a=this.props).onGetRef)==null||i.call(a,r,n,o),this.dynamicComponentInstanceMap.set(n.id,o),this.refManager.add(n.value.refId||n.id,r)});b(this,"rerender",r=>{var n;this.props.adapter.clear(),this.setState({pageModel:new zt(r)}),(n=this.state.pageModel)==null||n.emitter.emit("onNodeChange",{value:r,preValue:this.state.pageModel,node:this.state.pageModel})});this.state={pageModel:r.pageModel||new zt(r.page)},this.refManager=new uf}getPageModel(){return this.state.pageModel}componentDidMount(){const{render:r}=this.props;r&&(r.ref.current=this)}componentWillUnmount(){this.refManager.destroy()}render(){const{props:r}=this,{adapter:n,onGetComponent:o,onComponentDestroy:a,onComponentMount:i}=r,{pageModel:s}=this.state;if(!s)return console.warn("pageModel is null"),null;const c={...cf,...r.components};return n.pageRender(s,{libs:{},components:c,onGetRef:this.onGetRef,onGetComponent:o,onComponentMount:i,onComponentDestroy:a,$$context:{refs:this.refManager},renderMode:r.renderMode})}}const lf=()=>{const t=R.useRef(null);return{ref:t,rerender:function(...e){t.current&&t.current.rerender(...e)}}};class ff extends A.default.Component{constructor(r){super(r);b(this,"onDoubleClick",()=>{this.setState({hasError:!1,error:null})});this.state={hasError:!1,error:""}}static getDerivedStateFromError(r){return{hasError:!0,error:r}}componentDidCatch(r,n){var o,a;(a=(o=this.props).onError)==null||a.call(o,n)}render(){if(this.state.hasError){const{onDoubleClick:r}=this,n=this.props.node.value;console.error(this.props.node,this.props.children);const o=A.default.createElement("div",{style:{backgroundColor:"rgb(255 206 215 / 13%)",padding:"5px",color:"#ff0000b0",textAlign:"center",fontSize:"12px"}},"Render error, node id: ",n.id,", node name\uFF1A",n.title," component name\uFF1A",n.title||n.componentName,A.default.createElement("p",null,"msg: ",String(this.state.error)),A.default.createElement("button",{onDoubleClick:r,style:{border:"1px solid rgba(100,100,100,0.1)",backgroundColor:"#fff",padding:"5px 10px",borderRadius:"2px",color:"gray",cursor:"pointer",marginTop:"5px"}},"double click to refresh"),A.default.createElement("div",{style:{display:"none"}}));return A.default.createElement(this.props.targetComponent,{onlyRenderChild:!0},o)}return this.props.children}}class En{constructor(){b(this,"instanceMap",new Map)}get(e){return this.instanceMap.get(e)}add(e,r){const n=this.instanceMap.get(e);n?n.push(r):this.instanceMap.set(e,[r])}remove(e,r){const n=this.instanceMap.get(e);if(r!==void 0&&Array.isArray(n)){const o=n.filter(a=>a!==r);this.instanceMap.set(e,o)}else this.instanceMap.delete(e)}destroy(){this.instanceMap.clear()}}const Nn=t=>{const{node:e}=t,r=R.useMemo(()=>{var c,u;const s=(u=(c=e.material)==null?void 0:c.value)==null?void 0:u.isContainer;return Fe(s)?s:{placeholder:"Drag the component to place it",width:"100%",height:"100%",style:{}}},[t.node]),{placeholder:n,height:o,width:a,style:i}=r;return A.default.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"rgba(200,200,200,0.1)",border:"1px solid rgba(0,0,0,0.1)",borderRadius:"2px",fontSize:"14px",color:"gray",cursor:"default",minWidth:"300px",minHeight:"50px",width:a,height:o,...i}},n)};class pf extends A.default.Component{constructor(r){super(r);b(this,"instanceManager",new En);b(this,"renderRef");b(this,"dropPlaceholder",Nn);b(this,"onGetComponent",(r,n)=>{const o=this;class a extends A.default.Component{constructor(){super(...arguments);b(this,"_DESIGN_BOX",!0);b(this,"_NODE_MODEL",n);b(this,"_NODE_ID",n.id);b(this,"_UNIQUE_ID",`${n.id}_${K()}`);b(this,"_STATUS")}componentDidMount(){o.instanceManager.add(n.id,this)}componentWillUnmount(){this._STATUS="DESTROY",o.instanceManager.remove(n.id,this)}render(){var m;const{children:c=[],onlyRenderChild:u,...f}=this.props;let d=c;return ke(c)||(d=[c]),!Boolean(d.filter(Boolean).length)&&(((m=n.material)==null?void 0:m.value.isContainer)||n.value.componentName==="CPage")&&d.push(A.default.createElement(o.dropPlaceholder,{node:n})),u?d:A.default.createElement(r,f,...d)}}return A.default.forwardRef(function(s,c){return A.default.createElement(ff,{node:n,targetComponent:a},A.default.createElement(a,{ref:c,...s}))})});this.renderRef=A.default.createRef(),r.dropPlaceholder&&(this.dropPlaceholder=r.dropPlaceholder)}componentDidMount(){var r,n;(n=(r=this.props).onMount)==null||n.call(r,this)}getPageModel(){var r;return(r=this.renderRef.current)==null?void 0:r.state.pageModel}rerender(r){var n;return(n=this.renderRef.current)==null?void 0:n.rerender(r)}getInstancesById(r,n){let o=[...this.instanceManager.get(r)||[]];return n!==void 0&&(o=o.filter(a=>n===(a==null?void 0:a._UNIQUE_ID))),o}getInstanceByDom(r){const n=Mn(r);if(!n)return null;const o=$n(n);return(o==null?void 0:o.stateNode)||null}getDomsById(r,n){const o=this.getInstancesById(r),a=[];return o==null||o.forEach(i=>{if((i==null?void 0:i._STATUS)==="DESTROY")return;const s=Dn.findDOMNode(i);if(s&&!(s instanceof Text))if(n){const c=Array.from(s.querySelectorAll(n));a.push(...c)}else a.push(s)}),a}getDomRectById(r,n){return this.getDomsById(r,n).map(i=>i==null?void 0:i.getBoundingClientRect()).filter(Boolean)}render(){const{props:r,onGetComponent:n}=this,{render:o,...a}=r;return o&&(o.ref.current=this),A.default.createElement(Cn,{onGetComponent:n,...a,renderMode:"design",ref:this.renderRef})}}const Mn=t=>{if(!t)return null;const e=Object.keys(t).find(r=>r.startsWith("__reactInternalInstance$")||r.startsWith("__reactFiber$"))||"";return e?t[e]:Mn(t.parentElement)},$n=t=>{var e;return t?(e=t==null?void 0:t.stateNode)!=null&&e._DESIGN_BOX?t:$n(t.return):null},df=()=>{const t=R.useRef(null);return{ref:t,rerender:function(...e){t.current&&t.current.rerender(...e)},getInstancesById(e,r){var n;return((n=t.current)==null?void 0:n.getInstancesById(e,r))||[]},getInstanceByDom(e){var r;return((r=t.current)==null?void 0:r.getInstanceByDom(e))||null},getDomsById(e,r){var n;return((n=t.current)==null?void 0:n.getDomsById(e,r))||[]},getDomRectById(e,r){var n;return((n=t.current)==null?void 0:n.getDomRectById(e,r))||[]}}};var hf=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},An={exports:{}};(function(t,e){(function(r,n){t.exports=n()})(hf,function(){var r=function(){},n={},o={},a={};function i(l,m){l=l.push?l:[l];var v=[],y=l.length,j=y,w,O,x,$;for(w=function(D,U){U.length&&v.push(D),j--,j||m(v)};y--;){if(O=l[y],x=o[O],x){w(O,x);continue}$=a[O]=a[O]||[],$.push(w)}}function s(l,m){if(!!l){var v=a[l];if(o[l]=m,!!v)for(;v.length;)v[0](l,m),v.splice(0,1)}}function c(l,m){l.call&&(l={success:l}),m.length?(l.error||r)(m):(l.success||r)(l)}function u(l,m,v,y){var j=document,w=v.async,O=(v.numRetries||0)+1,x=v.before||r,$=l.replace(/[\?|#].*$/,""),D=l.replace(/^(css|img)!/,""),U,N;y=y||0,/(^css!|\.css$)/.test($)?(N=j.createElement("link"),N.rel="stylesheet",N.href=D,U="hideFocus"in N,U&&N.relList&&(U=0,N.rel="preload",N.as="style")):/(^img!|\.(png|gif|jpg|svg|webp)$)/.test($)?(N=j.createElement("img"),N.src=D):(N=j.createElement("script"),N.src=l,N.async=w===void 0?!0:w),N.onload=N.onerror=N.onbeforeload=function(bt){var rt=bt.type[0];if(U)try{N.sheet.cssText.length||(rt="e")}catch(Ht){Ht.code!=18&&(rt="e")}if(rt=="e"){if(y+=1,y<O)return u(l,m,v,y)}else if(N.rel=="preload"&&N.as=="style")return N.rel="stylesheet";m(l,rt,bt.defaultPrevented)},x(l,N)!==!1&&j.head.appendChild(N)}function f(l,m,v){l=l.push?l:[l];var y=l.length,j=y,w=[],O,x;for(O=function($,D,U){if(D=="e"&&w.push($),D=="b")if(U)w.push($);else return;y--,y||m(w)},x=0;x<j;x++)u(l[x],O,v)}function d(l,m,v){var y,j;if(m&&m.trim&&(y=m),j=(y?v:m)||{},y){if(y in n)throw"LoadJS";n[y]=!0}function w(O,x){f(l,function($){c(j,$),O&&c({success:O,error:x},$),s(y,$)},j)}if(j.returnPromise)return new Promise(w);w()}return d.ready=function(m,v){return i(m,function(y){c(v,y)}),d},d.done=function(m){s(m,[])},d.reset=function(){n={},o={},a={}},d.isDefined=function(m){return m in n},d})})(An);const Ge=An.exports,xn=t=>!!((t==null?void 0:t.name)&&(t==null?void 0:t.assets));class mf{constructor(e){b(this,"assets");b(this,"loadStatus");b(this,"_onSuccessList",[]);b(this,"_onErrorList",[]);this.assets=e,this.loadStatus="INIT"}load(){const e=this.assets||[],r=[];for(let n=0;n<e.length;n++){const o=e[n];if(o.id||(o.id=K()),r.push(o.id),xn(o)){const a=o.assets.map(i=>i.src);Ge(a,o.id)}else Ge(o.src,o.id)}return setTimeout(()=>{Ge.ready(r,{success:()=>{this._onSuccessList.forEach(n=>n())},error:n=>{this._onErrorList.forEach(o=>o(n))}})},0),this}onSuccess(e){return this._onSuccessList.push(e),this}onError(e){return this._onErrorList.push(e),this}}_.AssetLoader=mf,_.ComponentInstanceManager=En,_.DefaultDropPlaceholder=Nn,_.DesignRender=pf,_.ReactAdapter=af,_.Render=Cn,_.getAdapter=We,_.isAssetPackage=xn,_.useDesignRender=df,_.useRender=lf,Object.defineProperties(_,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
//# sourceMappingURL=index.umd.js.map
